"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[1717],{96330:function(e,n,t){t.d(n,{K1:function(){return d},Rx:function(){return o},S8:function(){return i},Vr:function(){return s},cG:function(){return c},ld:function(){return l},n_:function(){return f},oQ:function(){return u}});var r=t(9783),a=t.n(r),o=function(e){return e.Dataset="dataset",e.Testing="testing",e.Configuration="configuration",e.KnowledgeGraph="knowledgeGraph",e}({}),c=function(e){return e.UNSTART="0",e.RUNNING="1",e.CANCEL="2",e.DONE="3",e.FAIL="4",e}({}),u=function(e){return e.Improvise="Improvise",e.Precise="Precise",e.Balance="Balance",e}({}),i=a()(a()(a()({},u.Improvise,{temperature:.9,top_p:.9,frequency_penalty:.2,presence_penalty:.4,max_tokens:512}),u.Precise,{temperature:.1,top_p:.3,frequency_penalty:.7,presence_penalty:.4,max_tokens:512}),u.Balance,{temperature:.5,top_p:.5,frequency_penalty:.7,presence_penalty:.4,max_tokens:512}),s=function(e){return e.Embedding="embedding",e.Chat="chat",e.Image2text="image2text",e.Speech2text="speech2text",e.Rerank="rerank",e.TTS="tts",e}({}),l=function(e){return e.DocumentId="doc_id",e.KnowledgeId="id",e}({}),f=function(e){return e.Virtual="virtual",e.Visual="visual",e}({}),d=function(e){return e.Naive="naive",e.Qa="qa",e.Resume="resume",e.Manual="manual",e.Table="table",e.Paper="paper",e.Book="book",e.Laws="laws",e.Presentation="presentation",e.Picture="picture",e.One="one",e.Audio="audio",e.Email="email",e.Tag="tag",e.KnowledgeGraph="knowledge_graph",e}({})},2938:function(e,n,t){t.d(n,{H0:function(){return A},IV:function(){return z},NT:function(){return B},Qe:function(){return T},UL:function(){return Z},Y2:function(){return q},c5:function(){return R},cE:function(){return O},ox:function(){return K},sO:function(){return G},vv:function(){return D},vy:function(){return H},y7:function(){return V},ye:function(){return M}});var r=t(19632),a=t.n(r),o=t(97857),c=t.n(o),u=t(9783),i=t.n(u),s=t(15009),l=t.n(s),f=t(99289),d=t.n(f),p=t(5574),v=t.n(p),g=t(39918),m=t(1079),h=t(40169),b=t(60806),k=t(61921),w=t(71250),_=t(45360),x=t(54683),j=t(24809),y=t(96486),C=t(67294),S=t(67421),N=t(57632),E=t(86968),I=t(96100),P=t(39259),O=function(){var e=(0,C.useState)({}),n=v()(e,2),t=n[0],r=n[1];return{currentRecord:t,setRecord:function(e){r(e)}}},T=function(){var e=(0,C.useState)(""),n=v()(e,2),t=n[0],r=n[1];return{handleInputChange:(0,C.useCallback)((function(e){var n=e.target.value;r(n)}),[]),searchString:t}},Z=function(){var e=(0,S.$G)().i18n,n=(0,P.WH)().saveSetting;return function(t){e.changeLanguage(h.Kj[t]),n({language:t})}},M=function(){var e=(0,E.qM)("common").t,n=(0,I.fz)(),t=n.setPaginationParams,r=n.page,a=n.size,o=(0,C.useCallback)((function(e,n){t(e,n)}),[t]),c=(0,C.useCallback)((function(e){t(e.page,e.pageSize)}),[t]);return{pagination:(0,C.useMemo)((function(){return{showQuickJumper:!0,total:0,showSizeChanger:!0,current:r,pageSize:a,pageSizeOptions:[1,2,10,20,50,100],onChange:o,showTotal:function(n){return"".concat(e("total")," ").concat(n)}}}),[e,o,r,a]),setPagination:c}},z=function(){var e=(0,C.useState)({}),n=v()(e,2),t=n[0],r=n[1],a=(0,C.useCallback)(d()(l()().mark((function e(){var n;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.Z.get("/conf.json");case 2:n=e.sent,r(n.data);case 4:case"end":return e.stop()}}),e)}))),[]);return(0,C.useEffect)((function(){a()}),[a]),t},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.Z.completeConversation,n=(0,C.useState)({}),t=v()(n,2),r=t[0],a=t[1],o=(0,C.useState)(!0),u=v()(o,2),s=u[0],f=u[1],p=(0,C.useRef)(),m=(0,C.useCallback)((function(){p.current&&clearTimeout(p.current),p.current=setTimeout((function(){a({}),clearTimeout(p.current)}),1e3)}),[]),h=(0,C.useCallback)(function(){var n=d()(l()().mark((function n(t,r){var o,u,s,d,p,v,h,b,w;return l()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,f(!1),n.next=4,fetch(e,{method:"POST",headers:i()(i()({},g._n,(0,k.cD)()),"Content-Type","application/json"),body:JSON.stringify(t),signal:null==r?void 0:r.signal});case 4:u=n.sent,s=u.clone().json(),d=null==u||null===(o=u.body)||void 0===o?void 0:o.pipeThrough(new TextDecoderStream).pipeThrough(new j.m).getReader();case 7:return n.next=10,null==d?void 0:d.read();case 10:if(!(p=n.sent)){n.next=18;break}if(v=p.done,h=p.value,!v){n.next=17;break}return console.info("done"),m(),n.abrupt("break",20);case 17:try{b=JSON.parse((null==h?void 0:h.data)||""),"boolean"!=typeof(w=null==b?void 0:b.data)&&(console.info("data:",w),a(c()(c()({},w),{},{conversationId:null==t?void 0:t.conversation_id})))}catch(e){console.warn(e)}case 18:n.next=7;break;case 20:return console.info("done?"),f(!0),m(),n.next=25,s;case 25:return n.t0=n.sent,n.t1=u,n.abrupt("return",{data:n.t0,response:n.t1});case 30:n.prev=30,n.t2=n.catch(0),f(!0),m(),console.warn(n.t2);case 35:case"end":return n.stop()}}),n,null,[[0,30]])})));return function(e,t){return n.apply(this,arguments)}}(),[e,m]);return{send:h,answer:r,done:s,setDone:f,resetAnswer:m}},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.Z.tts,n=(0,C.useCallback)(function(){var n=d()(l()().mark((function n(t){var r,a;return l()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(e,{method:"POST",headers:i()(i()({},g._n,(0,k.cD)()),"Content-Type","application/json"),body:JSON.stringify(t)});case 2:return r=n.sent,n.prev=3,n.next=6,r.clone().json();case 6:0!==(null==(a=n.sent)?void 0:a.code)&&_.ZP.error(null==a?void 0:a.message),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),console.warn("ðŸš€ ~ error:",n.t0);case 13:return n.abrupt("return",r);case 14:case"end":return n.stop()}}),n,null,[[3,10]])})));return function(e){return n.apply(this,arguments)}}(),[e]);return{read:n}},B=function(){var e=(0,C.useState)(""),n=v()(e,2),t=n[0],r=n[1];return{handleInputChange:function(e){var n=e.target.value.replaceAll("\\n","\n").replaceAll("\\t","\t");r(n)},value:t,setValue:r}},V=function(){var e=(0,C.useState)([]),n=v()(e,2),t=n[0],r=n[1],o=function(e){var n=(0,C.useRef)(null),t=(0,C.useCallback)((function(){var t;e&&(null===(t=n.current)||void 0===t||t.scrollIntoView({behavior:"instant"}))}),[e]);return(0,C.useEffect)((function(){t()}),[t]),n}(t),u=(0,C.useCallback)((function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";r((function(t){return[].concat(a()(t),[c()(c()({},e),{},{id:(0,w.Kj)(e)}),{role:m.Cs.Assistant,content:n,id:(0,w.Kj)(c()(c()({},e),{},{role:m.Cs.Assistant}))}])}))}),[]),i=(0,C.useCallback)((function(e){r((function(n){var t;return[].concat(a()(null!==(t=null==n?void 0:n.slice(0,-1))&&void 0!==t?t:[]),[c()({role:m.Cs.Assistant,content:e.answer,reference:e.reference,id:(0,w.Kj)({id:e.id,role:m.Cs.Assistant}),prompt:e.prompt,audio_binary:e.audio_binary},(0,y.omit)(e,"reference"))])}))}),[]),s=(0,C.useCallback)((function(){r((function(e){var n;return null!==(n=null==e?void 0:e.slice(0,-2))&&void 0!==n?n:[]}))}),[]),l=(0,C.useCallback)((function(e){r((function(n){var t;return null!==(t=null==n?void 0:n.filter((function(n){return n.id!==e})))&&void 0!==t?t:[]}))}),[r]),f=(0,C.useCallback)((function(e){r((function(n){var t=n.findIndex((function(n){return n.id===e}));if(-1!==t){var r,o=null!==(r=n.slice(0,t+2))&&void 0!==r?r:[],u=o.at(-1);return o=u?[].concat(a()(o.slice(0,-1)),[c()(c()({},u),{},{content:"",reference:void 0,prompt:void 0})]):o}return n}))}),[r]);return{ref:o,derivedMessages:t,setDerivedMessages:r,addNewestQuestion:u,addNewestAnswer:i,removeLatestMessage:s,removeMessageById:l,removeMessagesAfterCurrentMessage:f}},D=function(e){var n=e.removeMessagesAfterCurrentMessage,t=e.sendMessage,r=e.messages,a=(0,C.useCallback)(function(){var e=d()(l()().mark((function e(a){var o,u;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.id&&(n(a.id),-1!==(o=r.findIndex((function(e){return e.id===a.id})))&&(u=r.slice(0,o)),t({message:c()(c()({},a),{},{id:(0,N.Z)()}),messages:u}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[n,t,r]);return{regenerateMessage:a}},H=function(e){var n=(0,C.useState)(""),t=v()(n,2),r=t[0],a=t[1],o=(0,C.useCallback)((function(e){return function(){a(e)}}),[]);return(0,C.useEffect)((function(){e&&a(e)}),[e]),{selectedId:r,handleItemClick:o}},K=function(){var e,n=(0,P.fS)(!0).data;return null!==(e=null==n?void 0:n.llm_id)&&void 0!==e?e:""},L={naive:128,knowledge_graph:8192},G=function(e){return(0,C.useCallback)((function(n){n in L&&e.setFieldValue(["parser_config","chunk_token_num"],L[n])}),[e])},q=function(e){var n=e.form,t=e.visible,r=(0,C.useRef)();(0,C.useEffect)((function(){r.current=t}),[t]);var a=r.current;(0,C.useEffect)((function(){!t&&a&&n.resetFields()}),[n,a,t])}},96100:function(e,n,t){t.d(n,{HK:function(){return f},Uu:function(){return l},fz:function(){return g},nT:function(){return v},pE:function(){return d},wy:function(){return p}});var r=t(5574),a=t.n(r),o=t(96330),c=t(67294),u=t(86004),i=function(e){return e.Second="2",e.Third="3",e}({}),s=function(e){return(0,u.TH)().pathname.split("/")[e]||""},l=function(){return s(i.Second)},f=function(){return s(i.Third)},d=function(){var e=(0,u.lr)(),n=a()(e,1)[0];return{documentId:n.get(o.ld.DocumentId)||"",knowledgeId:n.get(o.ld.KnowledgeId)||""}},p=function(){var e=(0,u.s0)();return(0,c.useCallback)((function(n){e(n,{state:{from:n}})}),[e])},v=function(){var e=(0,u.s0)(),n=d().knowledgeId;return(0,c.useCallback)((function(){e("/knowledge/".concat(o.Rx.Dataset,"?id=").concat(n))}),[n,e])},g=function(){var e=(0,u.lr)(),n=a()(e,2),t=n[0],r=n[1],o=(0,c.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1?arguments[1]:void 0;t.set("page",e.toString()),n&&t.set("size",n.toString()),r(t)}),[r,t]);return{setPaginationParams:o,page:Number(t.get("page"))||1,size:Number(t.get("size"))||10}}},57009:function(e,n,t){t.r(n),t.d(n,{default:function(){return pe}});var r=t(26058),a=t(9361),o=t(96074),c=t(67294),u=t(86004),i=(t(54707),Object.defineProperty),s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,d=(e,n,t)=>n in e?i(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;const p=e=>c.createElement("svg",((e,n)=>{for(var t in n||(n={}))l.call(n,t)&&d(e,t,n[t]);if(s)for(var t of s(n))f.call(n,t)&&d(e,t,n[t]);return e})({width:15,height:15,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c.createElement("g",{clipPath:"url(#file-management_svg__a)"},c.createElement("path",{d:"M7.907 4.45 7.28 3.194c-.18-.361-.27-.542-.405-.674a1.126 1.126 0 0 0-.421-.26c-.179-.061-.38-.061-.785-.061H3.517c-.63 0-.946 0-1.187.122-.212.108-.384.28-.492.492-.123.241-.123.557-.123 1.187v.45m0 0h8.557c.945 0 1.418 0 1.78.184.317.162.576.42.738.738.184.362.184.835.184 1.78V9.63c0 .946 0 1.419-.184 1.78-.162.318-.42.576-.738.738-.362.184-.835.184-1.78.184H4.417c-.945 0-1.418 0-1.78-.184a1.688 1.688 0 0 1-.738-.738c-.184-.361-.184-.834-.184-1.78V4.45Z",stroke:"currentColor",strokeWidth:1.689,strokeLinecap:"round",strokeLinejoin:"round"})),c.createElement("defs",null,c.createElement("clipPath",{id:"file-management_svg__a"},c.createElement("path",{fill:"#fff",transform:"translate(.59 .51)",d:"M0 0h13.51v13.51H0z"}))));var v=Object.defineProperty,g=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,b=(e,n,t)=>n in e?v(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;const k=e=>c.createElement("svg",((e,n)=>{for(var t in n||(n={}))m.call(n,t)&&b(e,t,n[t]);if(g)for(var t of g(n))h.call(n,t)&&b(e,t,n[t]);return e})({className:"graph_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:200,height:200},e),c.createElement("path",{d:"m403.687 669.564-90.216 26.017a156.733 156.733 0 1 1-24.157-80.038l96.046-27.69a156.817 156.817 0 0 1 114.728-143.358V307.824a156.733 156.733 0 1 1 83.591 0v136.67a156.44 156.44 0 0 1 63.007 34.524l63.466-38.243a156.733 156.733 0 1 1 42.13 72.202l-60.561 36.487a157.1 157.1 0 0 1 6.896 46.122 156.002 156.002 0 0 1-23.656 82.838l57.05 54.94a156.733 156.733 0 1 1-57.218 60.938l-61.439-59.182a156.064 156.064 0 0 1-71.47 17.199 156.712 156.712 0 0 1-138.218-82.755zm394.654-232.32.083.146a73.142 73.142 0 1 0-.083-.147zM541.884 668.727a73.142 73.142 0 1 0 0-146.285 73.142 73.142 0 0 0 0 146.285zm0-438.853a73.142 73.142 0 1 0 0-146.284 73.142 73.142 0 0 0 0 146.284zm219.948 585.66a73.142 73.142 0 1 0 103.444 103.443 73.142 73.142 0 0 0-103.444-103.444zm-534.46-135.21a73.142 73.142 0 1 0-141.31 37.826 73.142 73.142 0 0 0 141.31-37.825z",fill:"currentColor"}));var w=Object.defineProperty,_=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,y=(e,n,t)=>n in e?w(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;const C=e=>c.createElement("svg",((e,n)=>{for(var t in n||(n={}))x.call(n,t)&&y(e,t,n[t]);if(_)for(var t of _(n))j.call(n,t)&&y(e,t,n[t]);return e})({width:15,height:15,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c.createElement("g",{clipPath:"url(#knowledge-base_svg__a)"},c.createElement("path",{d:"M12.331 3.324c0 .933-2.268 1.69-5.066 1.69s-5.066-.757-5.066-1.69m10.132 0c0-.932-2.268-1.688-5.066-1.688s-5.066.756-5.066 1.688m10.132 0v7.881c0 .935-2.252 1.689-5.066 1.689-2.815 0-5.066-.754-5.066-1.689v-7.88m10.132 3.94c0 .934-2.252 1.689-5.066 1.689-2.815 0-5.066-.755-5.066-1.69",stroke:"currentColor",strokeWidth:1.689,strokeLinecap:"round",strokeLinejoin:"round"})),c.createElement("defs",null,c.createElement("clipPath",{id:"knowledge-base_svg__a"},c.createElement("path",{fill:"#fff",transform:"translate(.51 .51)",d:"M0 0h13.51v13.51H0z"}))));var S=t(86968),N=t(2938),E=t(96100),I=t(38545),P=t(68795),O=t(42075),T=t(78045),Z=t(86250),M=t(19632),z=t.n(M),A=t(97857),R=t.n(A),B=t(13769),V=t.n(B),D=t(1210),H=t(39259),K=t(68997),L="layout___Ps7xZ",G="divider___RVUOM",q="clickAvailable___KgAij",W=t(85893),$=function(){var e,n=(0,H.jd)().data;return(0,W.jsx)(K.Z,{size:32,onClick:function(){u.m8.push("/user-setting")},className:q,src:null!==(e=n.avatar)&&void 0!==e?e:"/user.jpg"})},F=t(98236),Q=t(40169),U=t(90250),J=t(58532),Y="toolbarWrapper___sjvth",X="circle___O8ZjN",ee=["children"],ne=function(e){var n=e.children,t=V()(e,ee);return(0,W.jsx)("div",R()(R()({},t),{},{className:X,children:n}))},te=function(){window.open("https://github.com/w2874382167","target")},re=function(){(0,S.qM)("common").t;var e=(0,F.Fg)(),n=e.setTheme,t=e.theme,r=((0,H.jd)().data.language,Q.qg.map((function(e){return{key:e,label:(0,W.jsx)("span",{children:Q.Wy[e]})}})).reduce((function(e,n){return[].concat(z()(e),[{type:"divider"},n])}),[]),c.useCallback((function(){n("light")}),[n])),a=c.useCallback((function(){n("dark")}),[n]);return(0,W.jsx)("div",{className:Y,children:(0,W.jsxs)(O.Z,{wrap:!0,size:16,children:[(0,W.jsx)(ne,{children:(0,W.jsx)(D.Z,{onClick:te})}),(0,W.jsx)(ne,{children:"dark"===t?(0,W.jsx)(U.Z,{onClick:r,size:20}):(0,W.jsx)(J.Z,{onClick:a,size:20})}),(0,W.jsx)($,{})]})})},ae="logoWrapper___B7B1l",oe="appIcon___x4rus",ce="appName___WliRD",ue="radioGroup___pTbHv",ie="radioGroupDark___uxjib",se="radioButtonIcon___vE17s",le=r.Z.Header,fe=function(){var e=a.Z.useToken().token.colorBgContainer,n=(0,E.wy)(),t=(0,u.TH)().pathname,r=(0,S.qM)("header").t,o=(0,N.IV)(),i=(0,F.Fg)().theme,s=(0,c.useMemo)((function(){return[{path:"/knowledge",name:r("knowledgeBase"),icon:C},{path:"/chat",name:r("chat"),icon:I.Z},{path:"/search",name:r("search"),icon:P.Z},{path:"/flow",name:r("flow"),icon:k},{path:"/file",name:r("fileManager"),icon:p}]}),[r]),l=(0,c.useMemo)((function(){var e;return(null===(e=s.find((function(e){return t.startsWith(e.path)})))||void 0===e?void 0:e.name)||"knowledge"}),[t,s]),f=(0,c.useCallback)((function(e){return function(t){t.preventDefault(),n(e)}}),[n]),d=(0,c.useCallback)((function(){n("/")}),[n]);return(0,W.jsxs)(le,{style:{padding:"0 16px",background:e,display:"flex",justifyContent:"space-between",alignItems:"center",height:"72px"},children:[(0,W.jsx)("a",{href:window.location.origin,children:(0,W.jsxs)(O.Z,{size:12,onClick:d,className:ae,children:[(0,W.jsx)("img",{src:"/logo.jpg",alt:"",className:oe}),(0,W.jsx)("span",{className:ce,children:o.appName})]})}),(0,W.jsx)(O.Z,{size:[0,8],wrap:!0,children:(0,W.jsx)(T.ZP.Group,{defaultValue:"a",buttonStyle:"solid",className:"dark"===i?ie:ue,value:l,children:s.map((function(e,n){return(0,W.jsx)(T.ZP.Button,{className:"".concat("dark"===i?"dark":"light"," ").concat(0===n?"first":""," ").concat(n===s.length-1?"last":""),value:e.name,children:(0,W.jsx)("a",{href:e.path,children:(0,W.jsxs)(Z.Z,{align:"center",gap:8,onClick:f(e.path),className:"cursor-pointer",children:[(0,W.jsx)(e.icon,{className:se,stroke:e.name===l?"black":"white"}),e.name]})})},e.name)}))})}),(0,W.jsx)(re,{})]})},de=r.Z.Content,pe=function(){var e=a.Z.useToken().token,n=e.colorBgContainer,t=e.borderRadiusLG;return(0,W.jsx)(r.Z,{className:L,children:(0,W.jsxs)(r.Z,{children:[(0,W.jsx)(fe,{}),(0,W.jsx)(o.Z,{orientationMargin:0,className:G}),(0,W.jsx)(de,{style:{minHeight:280,background:n,borderRadius:t,overflow:"auto",display:"flex"},children:(0,W.jsx)(u.j3,{})})]})})}},71250:function(e,n,t){t.d(n,{Bl:function(){return l},CE:function(){return p},IC:function(){return i},Kj:function(){return s},hH:function(){return v},mN:function(){return d},mV:function(){return g},o_:function(){return f}});var r=t(97857),a=t.n(r),o=t(1079),c=t(96486),u=t(57632),i=function(e){return e!==o.Pc&&""!==e},s=function(e){return"id"in e&&e.id?e.id:(0,u.Z)()},l=function(e){var n;return null!==(n=null==e?void 0:e.map((function(e){return a()(a()({},(0,c.omit)(e,"reference")),{},{id:s(e)})})))&&void 0!==n?n:[]},f=function(){return(0,u.Z)().replace(/-/g,"")},d=function(e){return"".concat(e.role,"_").concat(e.id)},p=function(e){return e.replace(/\\\[([\s\S]*?)\\\]/g,(function(e,n){return"$$".concat(n,"$$")})).replace(/\\\(([\s\S]*?)\\\)/g,(function(e,n){return"$".concat(n,"$")}))};function v(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/<think>([\s\S]*?)<\/think>/g,'<section class="think">$1</section>')}function g(e){return e!==o.uY.MaxTokensEnabled}}}]);
//# sourceMappingURL=layouts__index.af4738df.async.js.map