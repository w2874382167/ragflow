{"version":3,"file":"wrappers__auth.8e1b66ba.async.js","mappings":"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","sources":["webpack://web/./src/hooks/auth-hooks.ts","webpack://web/./src/wrappers/auth.tsx","webpack://web/./node_modules/antd/es/message/index.js"],"sourcesContent":["import authorizationUtil from '@/utils/authorization-util';\nimport { message } from 'antd';\nimport { useEffect, useMemo, useState } from 'react';\nimport { useNavigate, useSearchParams } from 'umi';\n\nexport const useLoginWithGithub = () => {\n  const [currentQueryParameters, setSearchParams] = useSearchParams();\n  const error = currentQueryParameters.get('error');\n  const newQueryParameters: URLSearchParams = useMemo(\n    () => new URLSearchParams(currentQueryParameters.toString()),\n    [currentQueryParameters],\n  );\n  const navigate = useNavigate();\n\n  if (error) {\n    message.error(error);\n    navigate('/login');\n    newQueryParameters.delete('error');\n    setSearchParams(newQueryParameters);\n    return;\n  }\n\n  const auth = currentQueryParameters.get('auth');\n\n  if (auth) {\n    authorizationUtil.setAuthorization(auth);\n    newQueryParameters.delete('auth');\n    setSearchParams(newQueryParameters);\n  }\n  return auth;\n};\n\nexport const useAuth = () => {\n  const auth = useLoginWithGithub();\n  const [isLogin, setIsLogin] = useState<Nullable<boolean>>(null);\n\n  useEffect(() => {\n    setIsLogin(!!authorizationUtil.getAuthorization() || !!auth);\n  }, [auth]);\n\n  return { isLogin };\n};\n","import { useAuth } from '@/hooks/auth-hooks';\nimport { redirectToLogin } from '@/utils/authorization-util';\nimport { Outlet } from 'umi';\n\nexport default () => {\n  const { isLogin } = useAuth();\n  if (isLogin === true) {\n    return <Outlet />;\n  } else if (isLogin === false) {\n    redirectToLogin();\n  }\n\n  return <></>;\n};\n","\"use client\";\n\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport React, { useContext } from 'react';\nimport { AppConfigContext } from '../app/context';\nimport ConfigProvider, { ConfigContext, globalConfig, warnContext } from '../config-provider';\nimport { getReactRender } from '../config-provider/UnstableContext';\nimport PurePanel from './PurePanel';\nimport useMessage, { useInternalMessage } from './useMessage';\nimport { wrapPromiseFn } from './util';\nlet message = null;\nlet act = callback => callback();\nlet taskQueue = [];\nlet defaultGlobalConfig = {};\nfunction getGlobalContext() {\n  const {\n    getContainer,\n    duration,\n    rtl,\n    maxCount,\n    top\n  } = defaultGlobalConfig;\n  const mergedContainer = (getContainer === null || getContainer === void 0 ? void 0 : getContainer()) || document.body;\n  return {\n    getContainer: () => mergedContainer,\n    duration,\n    rtl,\n    maxCount,\n    top\n  };\n}\nconst GlobalHolder = /*#__PURE__*/React.forwardRef((props, ref) => {\n  const {\n    messageConfig,\n    sync\n  } = props;\n  const {\n    getPrefixCls\n  } = useContext(ConfigContext);\n  const prefixCls = defaultGlobalConfig.prefixCls || getPrefixCls('message');\n  const appConfig = useContext(AppConfigContext);\n  const [api, holder] = useInternalMessage(Object.assign(Object.assign(Object.assign({}, messageConfig), {\n    prefixCls\n  }), appConfig.message));\n  React.useImperativeHandle(ref, () => {\n    const instance = Object.assign({}, api);\n    Object.keys(instance).forEach(method => {\n      instance[method] = function () {\n        sync();\n        return api[method].apply(api, arguments);\n      };\n    });\n    return {\n      instance,\n      sync\n    };\n  });\n  return holder;\n});\nconst GlobalHolderWrapper = /*#__PURE__*/React.forwardRef((_, ref) => {\n  const [messageConfig, setMessageConfig] = React.useState(getGlobalContext);\n  const sync = () => {\n    setMessageConfig(getGlobalContext);\n  };\n  React.useEffect(sync, []);\n  const global = globalConfig();\n  const rootPrefixCls = global.getRootPrefixCls();\n  const rootIconPrefixCls = global.getIconPrefixCls();\n  const theme = global.getTheme();\n  const dom = /*#__PURE__*/React.createElement(GlobalHolder, {\n    ref: ref,\n    sync: sync,\n    messageConfig: messageConfig\n  });\n  return /*#__PURE__*/React.createElement(ConfigProvider, {\n    prefixCls: rootPrefixCls,\n    iconPrefixCls: rootIconPrefixCls,\n    theme: theme\n  }, global.holderRender ? global.holderRender(dom) : dom);\n});\nfunction flushNotice() {\n  if (!message) {\n    const holderFragment = document.createDocumentFragment();\n    const newMessage = {\n      fragment: holderFragment\n    };\n    message = newMessage;\n    // Delay render to avoid sync issue\n    act(() => {\n      const reactRender = getReactRender();\n      reactRender(/*#__PURE__*/React.createElement(GlobalHolderWrapper, {\n        ref: node => {\n          const {\n            instance,\n            sync\n          } = node || {};\n          // React 18 test env will throw if call immediately in ref\n          Promise.resolve().then(() => {\n            if (!newMessage.instance && instance) {\n              newMessage.instance = instance;\n              newMessage.sync = sync;\n              flushNotice();\n            }\n          });\n        }\n      }), holderFragment);\n    });\n    return;\n  }\n  // Notification not ready\n  if (!message.instance) {\n    return;\n  }\n  // >>> Execute task\n  taskQueue.forEach(task => {\n    const {\n      type,\n      skipped\n    } = task;\n    // Only `skipped` when user call notice but cancel it immediately\n    // and instance not ready\n    if (!skipped) {\n      switch (type) {\n        case 'open':\n          {\n            act(() => {\n              const closeFn = message.instance.open(Object.assign(Object.assign({}, defaultGlobalConfig), task.config));\n              closeFn === null || closeFn === void 0 ? void 0 : closeFn.then(task.resolve);\n              task.setCloseFn(closeFn);\n            });\n            break;\n          }\n        case 'destroy':\n          act(() => {\n            message === null || message === void 0 ? void 0 : message.instance.destroy(task.key);\n          });\n          break;\n        // Other type open\n        default:\n          {\n            act(() => {\n              var _message$instance;\n              const closeFn = (_message$instance = message.instance)[type].apply(_message$instance, _toConsumableArray(task.args));\n              closeFn === null || closeFn === void 0 ? void 0 : closeFn.then(task.resolve);\n              task.setCloseFn(closeFn);\n            });\n          }\n      }\n    }\n  });\n  // Clean up\n  taskQueue = [];\n}\n// ==============================================================================\n// ==                                  Export                                  ==\n// ==============================================================================\nfunction setMessageGlobalConfig(config) {\n  defaultGlobalConfig = Object.assign(Object.assign({}, defaultGlobalConfig), config);\n  // Trigger sync for it\n  act(() => {\n    var _a;\n    (_a = message === null || message === void 0 ? void 0 : message.sync) === null || _a === void 0 ? void 0 : _a.call(message);\n  });\n}\nfunction open(config) {\n  const result = wrapPromiseFn(resolve => {\n    let closeFn;\n    const task = {\n      type: 'open',\n      config,\n      resolve,\n      setCloseFn: fn => {\n        closeFn = fn;\n      }\n    };\n    taskQueue.push(task);\n    return () => {\n      if (closeFn) {\n        act(() => {\n          closeFn();\n        });\n      } else {\n        task.skipped = true;\n      }\n    };\n  });\n  flushNotice();\n  return result;\n}\nfunction typeOpen(type, args) {\n  const global = globalConfig();\n  if (process.env.NODE_ENV !== 'production' && !global.holderRender) {\n    warnContext('message');\n  }\n  const result = wrapPromiseFn(resolve => {\n    let closeFn;\n    const task = {\n      type,\n      args,\n      resolve,\n      setCloseFn: fn => {\n        closeFn = fn;\n      }\n    };\n    taskQueue.push(task);\n    return () => {\n      if (closeFn) {\n        act(() => {\n          closeFn();\n        });\n      } else {\n        task.skipped = true;\n      }\n    };\n  });\n  flushNotice();\n  return result;\n}\nconst destroy = key => {\n  taskQueue.push({\n    type: 'destroy',\n    key\n  });\n  flushNotice();\n};\nconst methods = ['success', 'info', 'warning', 'error', 'loading'];\nconst baseStaticMethods = {\n  open,\n  destroy,\n  config: setMessageGlobalConfig,\n  useMessage,\n  _InternalPanelDoNotUseOrYouWillBeFired: PurePanel\n};\nconst staticMethods = baseStaticMethods;\nmethods.forEach(type => {\n  staticMethods[type] = function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return typeOpen(type, args);\n  };\n});\n// ==============================================================================\n// ==                                   Test                                   ==\n// ==============================================================================\nconst noop = () => {};\n/** @internal Only Work in test env */\n// eslint-disable-next-line import/no-mutable-exports\nexport let actWrapper = noop;\nif (process.env.NODE_ENV === 'test') {\n  actWrapper = wrapper => {\n    act = wrapper;\n  };\n}\n/** @internal Only Work in test env */\n// eslint-disable-next-line import/no-mutable-exports\nexport let actDestroy = noop;\nif (process.env.NODE_ENV === 'test') {\n  actDestroy = () => {\n    message = null;\n  };\n}\nexport default staticMethods;"],"names":["useAuth","auth","_useSearchParams","useSearchParams","_useSearchParams2","_slicedToArray","currentQueryParameters","setSearchParams","error","get","newQueryParameters","useMemo","URLSearchParams","toString","navigate","useNavigate","message","authorizationUtil","setAuthorization","useLoginWithGithub","_useState","useState","_useState2","isLogin","setIsLogin","useEffect","_jsx","Outlet","redirectToLogin","_Fragment","act","callback","taskQueue","defaultGlobalConfig","getGlobalContext","getContainer","duration","rtl","maxCount","top","mergedContainer","document","body","GlobalHolder","props","ref","messageConfig","sync","getPrefixCls","useContext","prefixCls","appConfig","api","holder","Object","assign","instance","keys","forEach","method","apply","arguments","GlobalHolderWrapper","_","setMessageConfig","global","rootPrefixCls","getRootPrefixCls","rootIconPrefixCls","getIconPrefixCls","theme","getTheme","dom","iconPrefixCls","holderRender","flushNotice","holderFragment","createDocumentFragment","newMessage","fragment","reactRender","node","Promise","resolve","then","task","type","skipped","closeFn","open","config","setCloseFn","destroy","key","_message$instance","args","staticMethods","result","fn","push","_a","call","useMessage","_InternalPanelDoNotUseOrYouWillBeFired","_len","length","Array","_key","typeOpen"],"sourceRoot":""}