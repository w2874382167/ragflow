"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[8630],{33623:function(e,n,t){var r=t(5574),a=t.n(r),s=t(86968),o=t(63606),i=t(57132),c=t(83062),l=t(67294),u=t(74855),d=t(85893);n.Z=function(e){var n=e.text,t=(0,l.useState)(!1),r=a()(t,2),p=r[0],m=r[1],f=(0,s.qM)("common").t;return(0,d.jsx)(c.Z,{title:f(p?"copied":"copy"),children:(0,d.jsx)(u.CopyToClipboard,{text:n,onCopy:function(){m(!0),setTimeout((function(){m(!1)}),2e3)},children:p?(0,d.jsx)(o.Z,{}):(0,d.jsx)(i.Z,{})})})}},3012:function(e,n,t){t.d(n,{Z:function(){return G}});var r=t(19632),a=t.n(r),s=t(97857),o=t.n(s),i=t(15009),c=t.n(i),l=t(99289),u=t.n(l),d=t(5574),p=t.n(d),m=t(86968),f=t(93352),h=t(5089),v=t(51331),x=t(50888),g=t(45605),b=t(18429),j=t(5392),w=t(27496),Z=t(25593),k=t(38289),y=t(86250),_=t(96074),C=t(2487),I=t(4393),F=t(74330),P=t(42075),R=t(84553),L=t(77683),M=t(27361),B=t.n(M),U=t(67294),T=t(3234),S={messageInputWrapper:"messageInputWrapper___nie1o",documentCard:"documentCard___JpeyA",listWrapper:"listWrapper___CSYW_",inputWrapper:"inputWrapper___xWIXi",deleteIcon:"deleteIcon___ilZaY"},O=t(85893),D=Z.Z.Text,A=k.Z.TextArea,E=function(e){return B()(e,"response.data.0")},z=function(e){return e.reduce((function(e,n){return e.concat(B()(n,"response.data",[]))}),[])},W=function(e){return new Promise((function(n,t){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return n(r.result)},r.onerror=function(e){return t(e)}}))},N=function(e){var n=e.isShared,t=void 0!==n&&n,r=e.disabled,s=e.value,i=e.onPressEnter,l=e.sendDisabled,d=e.sendLoading,Z=e.onInputChange,k=e.conversationId,M=e.showUploadIcon,N=void 0===M||M,G=e.createConversationBeforeUploadDocument,K=e.uploadMethod,q=void 0===K?"upload_and_parse":K,H=(0,m.qM)("chat").t,Y=(0,f.an)().removeDocument,J=(0,f.wO)().deleteDocument,$=(0,f.hf)(),V=$.data,Q=$.setDocumentIds,X=(0,f.tC)(q).uploadAndParseDocument,ee=(0,U.useRef)(k),ne=(0,U.useState)([]),te=p()(ne,2),re=te[0],ae=te[1],se=function(){var e=u()(c()().mark((function e(n){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.url||n.preview){e.next=4;break}return e.next=3,W(n.originFileObj);case 3:n.preview=e.sent;case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),oe=function(){var e=u()(c()().mark((function e(n){var t,r,s,i;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.file,r=k,!G){e.next=7;break}return e.next=5,G(t.name);case 5:0===(null==(s=e.sent)?void 0:s.code)&&(r=s.data.id);case 7:return ae((function(e){return e.push(o()(o()({},t),{},{status:"uploading",originFileObj:t})),a()(e)})),e.next=10,X({conversationId:r,fileList:[t]});case 10:i=e.sent,ae((function(e){var n=e.filter((function(e){return e.uid!==t.uid}));return n.push(o()(o()({},t),{},{originFileObj:t,response:i,percent:100,status:0===(null==i?void 0:i.code)?"done":"error"})),n}));case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ie=re.some((function(e){return"uploading"===e.status})),ce=(0,U.useCallback)(function(){var e=u()(c()().mark((function e(n){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==n.key||!n.shiftKey){e.next=2;break}return e.abrupt("return");case 2:if("Enter"===n.key){e.next=4;break}return e.abrupt("return");case 4:if(!(l||ie||d)){e.next=6;break}return e.abrupt("return");case 6:n.preventDefault(),le();case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[re,i,ie]),le=(0,U.useCallback)(u()(c()().mark((function e(){var n;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ie){e.next=2;break}return e.abrupt("return");case 2:n=z(re.filter((function(e){return n=e,"number"==typeof(t=B()(n,"response.code"))&&0===t;var n,t}))),i(n),ae([]);case 5:case"end":return e.stop()}}),e)}))),[re,i,ie]),ue=(0,U.useState)(!1),de=p()(ue,2),pe=(de[0],de[1]),me=(0,U.useCallback)(function(){var e=u()(c()().mark((function e(n){var r;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=B()(n,"response.data",[]),!Array.isArray(r)||!r.length){e.next=12;break}if(!t){e.next=7;break}return e.next=5,J(r);case 5:e.next=9;break;case 7:return e.next=9,Y(r[0]);case 9:ae((function(e){return e.filter((function(e){return E(e)!==r[0]}))})),e.next=13;break;case 12:ae((function(e){return e.filter((function(e){return e.uid!==n.uid}))}));case 13:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[Y,J,t]),fe=(0,U.useCallback)((function(e){return V.find((function(n){return n.id===e}))}),[V]);return(0,U.useEffect)((function(){var e=z(re);Q(e)}),[re,Q]),(0,U.useEffect)((function(){ee.current&&k!==ee.current&&ae([]),ee.current=k}),[k,ae]),(0,O.jsxs)(y.Z,{gap:1,vertical:!0,className:S.messageInputWrapper,children:[(0,O.jsx)(A,{size:"large",placeholder:H("sendPlaceholder"),value:s,allowClear:!0,disabled:r,style:{border:"none",boxShadow:"none",padding:"0px 10px",marginTop:10},autoSize:{minRows:2,maxRows:10},onKeyDown:ce,onChange:Z,onCompositionStart:function(){return pe(!0)},onCompositionEnd:function(){return pe(!1)}}),(0,O.jsx)(_.Z,{style:{margin:"5px 30px 10px 0px"}}),(0,O.jsxs)(y.Z,{justify:"space-between",align:"center",children:[re.length>0&&(0,O.jsx)(C.Z,{grid:{gutter:16,xs:1,sm:1,md:1,lg:1,xl:2,xxl:4},dataSource:re,className:S.listWrapper,renderItem:function(e){var n,t,r,a,s,o=E(e),i=fe(o),c=(0,h.RT)(null!==(n=null==i?void 0:i.name)&&void 0!==n?n:""),l=null!==(t=null===(r=e.originFileObj)||void 0===r?void 0:r.name)&&void 0!==t?t:"";return(0,O.jsx)(C.Z.Item,{children:(0,O.jsxs)(I.Z,{className:S.documentCard,children:[(0,O.jsxs)(y.Z,{gap:10,align:"center",children:["uploading"===e.status?(0,O.jsx)(F.Z,{indicator:(0,O.jsx)(x.Z,{style:{fontSize:24},spin:!0})}):"error"===e.status?(0,O.jsx)(g.Z,{size:30}):(0,O.jsx)(T.Z,{id:o,name:l}),(0,O.jsxs)(y.Z,{vertical:!0,style:{width:"90%"},children:[(0,O.jsx)(D,{ellipsis:{tooltip:l},className:S.nameText,children:(0,O.jsxs)("b",{children:[" ",l]})}),"error"===e.status?H("uploadFailed"):(0,O.jsx)(O.Fragment,{children:100!==e.percent?H("uploading"):e.response?(0,O.jsxs)(P.Z,{children:[(0,O.jsxs)("span",{children:[null==c?void 0:c.toUpperCase(),","]}),(0,O.jsx)("span",{children:(0,v.td)(null!==(a=null===(s=fe(o))||void 0===s?void 0:s.size)&&void 0!==a?a:0)})]}):H("parsing")})]})]}),"uploading"!==e.status&&(0,O.jsx)("span",{className:S.deleteIcon,children:(0,O.jsx)(b.Z,{onClick:function(){return me(e)}})})]})})}}),(0,O.jsxs)(y.Z,{gap:5,align:"center",justify:"flex-end",style:{paddingRight:10,paddingBottom:10,width:re.length>0?"50%":"100%"},children:[N&&(0,O.jsx)(R.Z,{onPreview:se,onChange:oe,multiple:!1,onRemove:me,showUploadList:!1,beforeUpload:function(){return!1},children:(0,O.jsx)(L.ZP,{type:"primary",disabled:r,children:(0,O.jsx)(j.Z,{})})}),(0,O.jsx)(L.ZP,{type:"primary",onClick:le,loading:d,disabled:l||ie||d,children:(0,O.jsx)(w.Z,{})})]})]})]})},G=(0,U.memo)(N)},51961:function(e,n,t){t.d(n,{Z:function(){return me}});var r=t(9783),a=t.n(r),s=t(5574),o=t.n(s),i=t(67294),c=Object.defineProperty,l=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,p=(e,n,t)=>n in e?c(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;const m=e=>i.createElement("svg",((e,n)=>{for(var t in n||(n={}))u.call(n,t)&&p(e,t,n[t]);if(l)for(var t of l(n))d.call(n,t)&&p(e,t,n[t]);return e})({className:"doctor_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:200,height:200},e),i.createElement("path",{d:"m368.76 621.76 24.07 132.54c9.54 52.6 55.34 90.84 108.79 90.84 51.49 0 96.12-35.64 107.52-85.85l1.02-5.03 23.61-132.33 100.48 22.34 5.61 1.36c61.12 16.18 104.55 70.31 107.08 133.49l.12 5.77v60.26l-.12 3.46c-1.71 22.71-19.72 40.78-42.42 42.56l-3.62.14H200.86l-3.46-.12c-22.71-1.71-40.78-19.72-42.56-42.42l-.14-3.62v-60.26l.12-5.77c2.53-63.17 45.96-117.31 107.08-133.49l5.61-1.36 101.25-22.51zm247.52-468.98 3.46.12c22.71 1.71 40.78 19.72 42.56 42.42l.14 3.62v138.47h-323.1V198.94l.12-3.46c1.71-22.71 19.72-40.78 42.42-42.56l3.62-.14h230.78zm-115.39 23.08c-11.7 0-21.55 8.76-22.92 20.38l-.16 2.7v23.08h-23.08c-12.75.01-23.07 10.36-23.05 23.1.01 11.68 8.75 21.51 20.35 22.89l2.7.16h23.08v23.08c.01 12.75 10.36 23.07 23.1 23.05 11.68-.01 21.51-8.75 22.89-20.35l.16-2.7v-23.08h23.08c12.75-.01 23.07-10.36 23.05-23.1-.01-11.68-8.75-21.51-20.35-22.89l-2.7-.16h-23.08v-23.08c.01-12.75-10.33-23.08-23.07-23.08z",fill:"#009FFF"}),i.createElement("path",{d:"M616.28 106.62c50.98 0 92.31 41.33 92.31 92.31v230.79a207.068 207.068 0 0 1-61.78 147.8l97.46 21.69c87.02 19.34 148.94 96.52 148.95 185.67v60.26c0 50.98-41.33 92.31-92.31 92.31H200.86c-50.98 0-92.31-41.33-92.31-92.31v-60.26c.01-89.15 61.93-166.33 148.95-185.67l97.46-21.69a207.051 207.051 0 0 1-61.78-147.8V198.94c0-50.98 41.33-92.31 92.31-92.31l230.79-.01zM368.76 621.76l-101.25 22.5c-63.81 14.18-110.07 69.54-112.69 134.85l-.12 5.79v60.24c-.01 24.15 18.61 44.23 42.7 46.04l3.46.12H800.9c24.15.01 44.23-18.61 46.04-42.7l.12-3.46v-60.26c0-65.36-44.01-122.53-107.2-139.26l-5.61-1.36-100.48-22.34-23.61 132.33c-9.39 52.58-55.12 90.88-108.54 90.88-53.45 0-99.25-38.24-108.79-90.84l-24.07-132.53zm132.13 15.67c-29.55.04-58.77-6.26-85.69-18.46l23.06 127.09c5.28 29.15 29.77 50.94 59.34 52.8l4.04.12c29.54-.01 55.26-20.2 62.27-48.9l.83-3.92 22.8-127.62a207.062 207.062 0 0 1-86.65 18.89zm66.65-60.51 5.72-2.72c2.31-1.15 4.57-2.35 6.81-3.62l-.92.51c49.68-27.49 81.27-79.05 83.2-135.79l.09-5.56v-46.16h-323.1v46.16c-.04 53.71 26.66 103.94 71.22 133.96l.53.35 4.85 3.12c1.95 1.21 3.93 2.38 5.93 3.51l-4.11-2.38c1.71 1.02 3.44 2.01 5.17 2.98l-1.06-.6c4.55 2.56 9.23 4.89 14.01 6.99l-1.5-.69c1.62.74 3.23 1.45 4.85 2.12l-3.35-1.43c2.01.9 4.06 1.73 6.12 2.54l-2.77-1.11c2.08.85 4.13 1.66 6.23 2.42L442 580.2c3.77 1.48 7.6 2.82 11.47 4.02l-4.85-1.59c2.35.81 4.73 1.57 7.15 2.26l-2.31-.69c1.78.55 3.55 1.06 5.33 1.55l-3.02-.85c2.01.6 4.06 1.15 6.09 1.64l-3.07-.78c2.35.65 4.75 1.22 7.15 1.75l-4.08-.97c1.98.51 3.97.95 5.95 1.38l-1.87-.42c2.65.58 5.33 1.11 8.05 1.55l-6.19-1.15c2.31.48 4.66.92 7.02 1.29l-.83-.14c2.08.37 4.15.67 6.25.92l-5.42-.78c2.61.44 5.24.78 7.87 1.08l-2.45-.3c2.08.28 4.13.48 6.19.69l-3.74-.39c2.08.23 4.15.44 6.28.58l6.35.35 5.56.09 5.54-.09 6.32-.35c2.34-.17 4.67-.38 6.99-.65l-4.52.46c2.01-.18 4.02-.39 6-.65l-1.48.18c5.54-.64 11.04-1.56 16.48-2.77l-2.45.51c2.31-.46 4.62-1.02 6.92-1.62l-4.48 1.08c2.01-.46 4.04-.92 6.02-1.45l-1.55.39c2.05-.53 4.08-1.08 6.12-1.68l-4.57 1.29c2.08-.55 4.15-1.15 6.21-1.78l-1.64.48c2.45-.72 4.85-1.5 7.27-2.33l-5.63 1.85c2.7-.83 5.38-1.73 8.03-2.7l-2.4.85c1.92-.69 3.83-1.38 5.75-2.12l-3.35 1.27c2.15-.81 4.27-1.62 6.37-2.49l-3.02 1.22c2.6-1.03 5.19-2.12 7.73-3.27zm48.74-424.14H385.49c-24.15-.01-44.23 18.61-46.04 42.7l-.12 3.46v138.47h323.1V198.94c.01-24.15-18.61-44.23-42.7-46.04l-3.45-.12zm-115.39 23.08c12.75 0 23.08 10.33 23.08 23.08v23.08h23.08c12.75.01 23.07 10.34 23.07 23.09-.01 12.74-10.33 23.06-23.07 23.07h-23.08v23.08c0 12.75-10.33 23.08-23.08 23.08-12.75 0-23.08-10.33-23.08-23.08v-23.08h-23.08c-12.75-.01-23.07-10.34-23.07-23.09.01-12.74 10.33-23.06 23.07-23.07h23.08v-23.08c0-12.75 10.33-23.08 23.08-23.08z"}));var f=t(1079),h=t(86968),v=t(93967),x=t.n(v),g=t(93352),b=t(46008),j=t(5089),w=t(25593),Z=t(68997),k=t(86250),y=t(42075),_=t(2487),C=t(77683),I=t(3234),F=t(67421),P=t(373),R=t(10541),L=t(85576),M=t(85893),B=function(e){var n=e.visible,t=e.hideModal,r=(0,R.$F)().data,a=(0,F.$G)().t;return(0,M.jsx)(L.Z,{title:a("chunk.mind"),open:n,onCancel:t,width:"90vw",footer:null,children:(0,M.jsx)("section",{children:(0,M.jsx)(P.Z,{data:null==r?void 0:r.mind_map,show:!0})})})},U=t(18334),T=t(98236),S=t(38520),O=t(33623),D=t(30159),A=t(63437),E=t(65429),z=t(15381),W=t(98165),N=t(48689),G=t(78045),K=t(83062),q=t(15009),H=t.n(q),Y=t(99289),J=t.n(Y),$=t(22150),V=t(38289),Q=function(e){var n=e.visible,t=e.hideModal,r=e.onOk,a=e.loading,s=$.Z.useForm(),c=o()(s,1)[0],l=(0,i.useCallback)(J()(H()().mark((function e(){var n;return H()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.validateFields();case 2:return n=e.sent,e.abrupt("return",null==r?void 0:r({thumbup:!1,feedback:n.feedback}));case 4:case"end":return e.stop()}}),e)}))),[r,c]);return(0,M.jsx)(L.Z,{title:"Feedback",open:n,onOk:l,onCancel:t,confirmLoading:a,children:(0,M.jsx)($.Z,{name:"basic",labelCol:{span:0},wrapperCol:{span:24},style:{maxWidth:600},autoComplete:"off",form:c,children:(0,M.jsx)($.Z.Item,{name:"feedback",rules:[{required:!0,message:"Please input your feedback!"}],children:(0,M.jsx)(V.Z.TextArea,{rows:8,placeholder:"Please input your feedback!"})})})})},X=t(97857),ee=t.n(X),ne=t(91028),te=t(2938),re=t(31098),ae=t(87080),se=t(7306),oe=t(46693),ie=function(e){var n=e.visible,t=e.hideModal,r=e.prompt;return(0,M.jsx)(L.Z,{title:(0,M.jsxs)(y.Z,{children:[(0,M.jsx)(oe.Z,{name:"prompt",width:18}),"Prompt"]}),width:"80%",open:n,onCancel:t,footer:null,children:(0,M.jsx)(se.Z,{children:r})})},ce=function(e){var n=e.messageId,t=e.content,r=e.prompt,a=e.audioBinary,s=e.showLikeButton,c=e.showLoudspeaker,l=void 0===c||c,u=function(e){var n=(0,h.pG)(),t=n.visible,r=n.hideModal,a=n.showModal,s=(0,ne.Zo)(),o=s.feedback,c=s.loading,l=(0,i.useCallback)(function(){var n=J()(H()().mark((function n(t){return H()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o(ee()(ee()({},t),{},{messageId:e}));case 2:0===n.sent&&r();case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[o,r,e]);return{loading:c,onFeedbackOk:l,visible:t,hideModal:r,showModal:a}}(n),d=u.visible,p=u.hideModal,m=u.showModal,f=u.onFeedbackOk,v=u.loading,x=(0,h.pG)(),g=x.visible,b=x.hideModal,j=x.showModal,w=(0,F.$G)().t,Z=function(e,n){var t=(0,i.useRef)(null),r=(0,te.c5)().read,a=(0,i.useRef)(),s=(0,i.useState)(!1),c=o()(s,2),l=c[0],u=c[1],d=(0,i.useCallback)(J()(H()().mark((function e(){return H()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.current=new ae.i({audio:t.current,onPlaying:function(){u(!0)},onPause:function(){u(!1)},onChunkEnd:function(){},mimeType:MediaSource.isTypeSupported("audio/mpeg")?"audio/mpeg":'audio/mp4; codecs="mp4a.40.2"'}),e.next=3,a.current.init();case 3:case"end":return e.stop()}}),e)}))),[]),p=(0,i.useCallback)((function(){var e;null===(e=a.current)||void 0===e||e.pause()}),[]),m=(0,i.useCallback)(J()(H()().mark((function n(){var t,s;return H()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r({text:e});case 2:(t=n.sent)&&(null==a||null===(s=a.current)||void 0===s||s.feedWithResponse(t));case 4:case"end":return n.stop()}}),n)}))),[r,e]),f=(0,i.useCallback)(J()(H()().mark((function e(){return H()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l?(u(!1),p()):(u(!0),m());case 1:case"end":return e.stop()}}),e)}))),[u,m,l,p]);return(0,i.useEffect)((function(){if(n){var e=(0,re.BF)(n);if(e)try{var t;null===(t=a.current)||void 0===t||t.feed(e)}catch(e){console.warn(e)}}}),[n]),(0,i.useEffect)((function(){d()}),[d]),{ref:t,handleRead:f,isPlaying:l}}(t,a),k=Z.handleRead,y=Z.ref,_=Z.isPlaying,C=(0,i.useCallback)((function(){f({thumbup:!0})}),[f]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(G.ZP.Group,{size:"small",children:[(0,M.jsx)(G.ZP.Button,{value:"a",children:(0,M.jsx)(O.Z,{text:t})}),l&&(0,M.jsxs)(G.ZP.Button,{value:"b",onClick:k,children:[(0,M.jsx)(K.Z,{title:w("chat.read"),children:_?(0,M.jsx)(D.Z,{}):(0,M.jsx)(A.Z,{})}),(0,M.jsx)("audio",{src:"",ref:y})]}),s&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(G.ZP.Button,{value:"c",onClick:C,children:(0,M.jsx)(E.Z,{})}),(0,M.jsx)(G.ZP.Button,{value:"d",onClick:m,children:(0,M.jsx)(z.Z,{})})]}),r&&(0,M.jsx)(G.ZP.Button,{value:"e",onClick:j,children:(0,M.jsx)(S.UI,{style:{fontSize:"16px"}})})]}),d&&(0,M.jsx)(Q,{visible:d,hideModal:p,onOk:f,loading:v}),g&&(0,M.jsx)(ie,{visible:g,hideModal:b,prompt:r})]})},le=function(e){var n=e.content,t=e.messageId,r=e.sendLoading,a=e.removeMessageById,s=e.regenerateMessage,o=function(e,n){var t=(0,ne.RQ)(),r=t.deleteMessage,a=t.loading;return{onRemoveMessage:(0,i.useCallback)(J()(H()().mark((function t(){return H()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return t.next=3,r(e);case 3:0===t.sent&&(null==n||n(e));case 5:case"end":return t.stop()}}),t)}))),[r,e,n]),loading:a}}(t,a),c=o.onRemoveMessage,l=o.loading,u=(0,F.$G)().t;return(0,M.jsxs)(G.ZP.Group,{size:"small",children:[(0,M.jsx)(G.ZP.Button,{value:"a",children:(0,M.jsx)(O.Z,{text:n})}),s&&(0,M.jsx)(G.ZP.Button,{value:"b",onClick:s,disabled:r,children:(0,M.jsx)(K.Z,{title:u("chat.regenerate"),children:(0,M.jsx)(W.Z,{spin:r})})}),a&&(0,M.jsx)(G.ZP.Button,{value:"c",onClick:c,disabled:l,children:(0,M.jsx)(K.Z,{title:u("common.delete"),children:(0,M.jsx)(N.Z,{spin:l})})})]})},ue={messageItem:"messageItem___OK1Zd",messageItemSection:"messageItemSection___a_W_M",messageItemSectionLeft:"messageItemSectionLeft___nCfnq",messageItemContent:"messageItemContent___j99sG",messageItemContentReverse:"messageItemContentReverse___EgYgc",messageText:"messageText___vuU2B",messageTextDark:"messageTextDark___mYdLd",messageUserText:"messageUserText___yCJ20",messageEmpty:"messageEmpty___oF9mg",thumbnailImg:"thumbnailImg___ObcCZ",messageItemLeft:"messageItemLeft___L270A",messageItemRight:"messageItemRight___icDzT"},de=w.Z.Text,pe=function(e){var n=e.item,t=e.reference,r=e.loading,s=void 0!==r&&r,c=e.avatar,l=e.avatarDialog,u=e.sendLoading,d=void 0!==u&&u,p=e.clickDocumentButton,v=e.index,w=e.removeMessageById,F=e.regenerateMessage,P=e.showLikeButton,R=void 0===P||P,L=e.showLoudspeaker,S=void 0===L||L,O=e.visibleAvatar,D=void 0===O||O,A=(0,T.Fg)().theme,E=n.role===f.Cs.Assistant,z=n.role===f.Cs.User,W=(0,g.hf)(),N=W.data,G=W.setDocumentIds,K=(0,g.x2)(),q=K.data,H=K.setDocumentIds,Y=(0,h.pG)(),J=Y.visible,$=Y.hideModal,V=Y.showModal,Q=(0,i.useState)(""),X=o()(Q,2),ee=X[0],ne=X[1],te=(0,i.useMemo)((function(){var e;return null!==(e=null==t?void 0:t.doc_aggs)&&void 0!==e?e:[]}),[null==t?void 0:t.doc_aggs]),re=(0,i.useCallback)((function(e){return function(){ne(e),V()}}),[V]),ae=(0,i.useCallback)((function(){null==F||F(n)}),[F,n]);return(0,i.useEffect)((function(){var e,t=null!==(e=null==n?void 0:n.doc_ids)&&void 0!==e?e:[];if(t.length){G(t);var r=t.filter((function(e){return!(e in q)}));r.length&&H(r)}}),[n.doc_ids,G,H,q]),(0,M.jsxs)("div",{className:x()(ue.messageItem,a()(a()({},ue.messageItemLeft,n.role===f.Cs.Assistant),ue.messageItemRight,n.role===f.Cs.User)),children:[(0,M.jsx)("section",{className:x()(ue.messageItemSection,a()(a()({},ue.messageItemSectionLeft,n.role===f.Cs.Assistant),ue.messageItemSectionRight,n.role===f.Cs.User)),children:(0,M.jsxs)("div",{className:x()(ue.messageItemContent,a()({},ue.messageItemContentReverse,n.role===f.Cs.User)),children:[D&&(n.role===f.Cs.User?(0,M.jsx)(Z.Z,{size:40,src:null!=c?c:"/user.jpg"}):l?(0,M.jsx)(Z.Z,{size:40,src:l}):(0,M.jsx)(m,{style:{width:"38px",height:"38px"}})),(0,M.jsxs)(k.Z,{vertical:!0,gap:8,flex:1,children:[(0,M.jsx)(y.Z,{children:E?0!==v&&(0,M.jsx)(ce,{messageId:n.id,content:n.content,prompt:n.prompt,showLikeButton:R,audioBinary:n.audio_binary,showLoudspeaker:S}):(0,M.jsx)(le,{content:n.content,messageId:n.id,removeMessageById:w,regenerateMessage:F&&ae,sendLoading:d})}),(0,M.jsx)("div",{className:E?"dark"===A?ue.messageTextDark:ue.messageText:ue.messageUserText,style:{maxWidth:"664px"},children:(0,M.jsx)(b.Z,{loading:s,content:n.content,reference:t,clickDocumentButton:p})}),E&&te.length>0&&(0,M.jsx)(_.Z,{bordered:!0,dataSource:te,renderItem:function(e){return(0,M.jsx)(_.Z.Item,{children:(0,M.jsxs)(k.Z,{gap:"small",align:"center",children:[(0,M.jsx)(I.Z,{id:e.doc_id,name:e.doc_name}),(0,M.jsx)(U.Z,{documentId:e.doc_id,documentName:e.doc_name,prefix:"document",link:e.url,children:e.doc_name})]})})}}),z&&N.length>0&&(0,M.jsx)(_.Z,{bordered:!0,dataSource:N,renderItem:function(e){var n=(0,j.RT)(e.name);return(0,M.jsx)(_.Z.Item,{children:(0,M.jsxs)(k.Z,{gap:"small",align:"center",children:[(0,M.jsx)(I.Z,{id:e.id,name:e.name}),(0,j.Or)(n)?(0,M.jsx)(U.Z,{documentId:e.id,documentName:e.name,prefix:"document",children:e.name}):(0,M.jsx)(C.ZP,{type:"text",onClick:re(e.id),children:(0,M.jsx)(de,{style:{maxWidth:"40vw"},ellipsis:{tooltip:e.name},children:e.name})})]})})}})]})]})}),J&&(0,M.jsx)(B,{visible:J,hideModal:$,documentId:ee})]})},me=(0,i.memo)(pe)},62386:function(e,n,t){var r=t(60806),a=t(66582),s=t(78158),o=r.Z.listFile,i=r.Z.removeFile,c=r.Z.uploadFile,l=r.Z.renameFile,u=r.Z.getAllParentFolder,d=r.Z.createFolder,p=r.Z.connectFileToKnowledge,m=r.Z.get_document_file,f={listFile:{url:o,method:"get"},removeFile:{url:i,method:"post"},uploadFile:{url:c,method:"post"},renameFile:{url:l,method:"post"},getAllParentFolder:{url:u,method:"get"},createFolder:{url:d,method:"post"},connectFileToKnowledge:{url:p,method:"post"},getFile:{url:r.Z.getFile,method:"get",responseType:"blob"},getDocumentFile:{url:m,method:"get",responseType:"blob"},moveFile:{url:r.Z.moveFile,method:"post"}},h=(0,a.Z)(f,s.ZP);n.Z=h},51331:function(e,n,t){t.d(n,{AG:function(){return g},De:function(){return w},P2:function(){return d},Ph:function(){return u},qh:function(){return h},td:function(){return j},uA:function(){return x},vn:function(){return p}});var r=t(15009),a=t.n(r),s=t(99289),o=t.n(s),i=t(40169),c=t(62386),l=function(e){return new Promise((function(n,t){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){var e=new Image;e.src=r.result,e.onload=function(){var t=document.createElement("canvas"),r=t.getContext("2d"),a=e.width,s=e.height,o=100;a>s&&a>o?(s=s*o/a,a=o):s>o&&(a=a*o/s,s=o),t.width=a,t.height=s,null==r||r.drawImage(e,0,0,a,s);var i=t.toDataURL("image/png");n(i)},e.onerror=t},r.onerror=t}))},u=function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},d=function(e){var n=[];return e&&(n=[{uid:"1",name:"file",thumbUrl:e,status:"done"}]),n},p=function(){var e=o()(a()().mark((function e(n){var t,r,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Array.isArray(n)&&n.length>0)){e.next=11;break}if(t=n[0],!(r=t.originFileObj)){e.next=10;break}return e.next=6,l(r);case 6:return s=e.sent,e.abrupt("return",s);case 10:return e.abrupt("return",t.thumbUrl);case 11:return e.abrupt("return","");case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function m(e,n){return f.apply(this,arguments)}function f(){return(f=o()(a()().mark((function e(n,t){var r,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.Z.getDocumentFile({},n);case 2:return r=e.sent,s=new Blob([r.data],{type:t||r.data.type}),e.abrupt("return",s);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return(v=o()(a()().mark((function e(n){var t,r,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(n,i.nK.Html);case 2:t=e.sent,r=URL.createObjectURL(t),(s=document.createElement("a")).href=r,s.click(),URL.revokeObjectURL(r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=function(e,n){var t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,n&&(r.download=n),r.click(),window.URL.revokeObjectURL(t)},g=function(){var e=o()(a()().mark((function e(n){var t,r,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.id,r=n.filename,e.next=3,m(t);case 3:s=e.sent,x(s,r);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),b=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],j=function(e){for(var n=0,t=("string"==typeof e?parseInt(e,10):e)||0;t>=1024&&++n;)t/=1024;return t.toFixed(t<10&&n>0?1:0)+" "+b[n]},w=function(){var e=o()(a()().mark((function e(n,t){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new Blob([JSON.stringify(n)],{type:i.nK.Json}),x(r,t);case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=8630.a0de76f1.async.js.map