{"version":3,"file":"8630.a0de76f1.async.js","mappings":"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","sources":["webpack://web/./src/components/copy-to-clipboard.tsx","webpack://web/./src/components/message-input/index.less?677d","webpack://web/./src/components/message-input/index.tsx","webpack://web/./src/assets/svg/doctor.svg","webpack://web/./src/components/indented-tree/modal.tsx","webpack://web/./src/components/message-item/feedback-modal.tsx","webpack://web/./src/components/message-item/prompt-modal.tsx","webpack://web/./src/components/message-item/group-button.tsx","webpack://web/./src/components/message-item/hooks.ts","webpack://web/./src/components/message-item/index.less?7287","webpack://web/./src/components/message-item/index.tsx","webpack://web/./src/services/file-manager-service.ts","webpack://web/./src/utils/file-util.ts"],"sourcesContent":["import { useTranslate } from '@/hooks/common-hooks';\nimport { CheckOutlined, CopyOutlined } from '@ant-design/icons';\nimport { Tooltip } from 'antd';\nimport { useState } from 'react';\nimport { CopyToClipboard as Clipboard, Props } from 'react-copy-to-clipboard';\n\nconst CopyToClipboard = ({ text }: Props) => {\n  const [copied, setCopied] = useState(false);\n  const { t } = useTranslate('common');\n\n  const handleCopy = () => {\n    setCopied(true);\n    setTimeout(() => {\n      setCopied(false);\n    }, 2000);\n  };\n\n  return (\n    <Tooltip title={copied ? t('copied') : t('copy')}>\n      <Clipboard text={text} onCopy={handleCopy}>\n        {copied ? <CheckOutlined /> : <CopyOutlined />}\n      </Clipboard>\n    </Tooltip>\n  );\n};\n\nexport default CopyToClipboard;\n","// extracted by mini-css-extract-plugin\nexport default {\"messageInputWrapper\":\"messageInputWrapper___nie1o\",\"documentCard\":\"documentCard___JpeyA\",\"listWrapper\":\"listWrapper___CSYW_\",\"inputWrapper\":\"inputWrapper___xWIXi\",\"deleteIcon\":\"deleteIcon___ilZaY\"};","import { useTranslate } from '@/hooks/common-hooks';\nimport {\n  useDeleteDocument,\n  useFetchDocumentInfosByIds,\n  useRemoveNextDocument,\n  useUploadAndParseDocument,\n} from '@/hooks/document-hooks';\nimport { getExtension } from '@/utils/document-util';\nimport { formatBytes } from '@/utils/file-util';\nimport {\n  CloseCircleOutlined,\n  InfoCircleOutlined,\n  LoadingOutlined,\n  PaperClipOutlined,\n  SendOutlined,\n} from '@ant-design/icons';\nimport type { GetProp, UploadFile } from 'antd';\nimport {\n  Button,\n  Card,\n  Divider,\n  Flex,\n  Input,\n  List,\n  Space,\n  Spin,\n  Typography,\n  Upload,\n  UploadProps,\n} from 'antd';\nimport get from 'lodash/get';\nimport {\n  ChangeEventHandler,\n  memo,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport FileIcon from '../file-icon';\nimport styles from './index.less';\n\ntype FileType = Parameters<GetProp<UploadProps, 'beforeUpload'>>[0];\nconst { Text } = Typography;\n\nconst { TextArea } = Input;\n\nconst getFileId = (file: UploadFile) => get(file, 'response.data.0');\n\nconst getFileIds = (fileList: UploadFile[]) => {\n  const ids = fileList.reduce((pre, cur) => {\n    return pre.concat(get(cur, 'response.data', []));\n  }, []);\n\n  return ids;\n};\n\nconst isUploadSuccess = (file: UploadFile) => {\n  const code = get(file, 'response.code');\n  return typeof code === 'number' && code === 0;\n};\n\ninterface IProps {\n  disabled: boolean;\n  value: string;\n  sendDisabled: boolean;\n  sendLoading: boolean;\n  onPressEnter(documentIds: string[]): void;\n  onInputChange: ChangeEventHandler<HTMLTextAreaElement>;\n  conversationId: string;\n  uploadMethod?: string;\n  isShared?: boolean;\n  showUploadIcon?: boolean;\n  createConversationBeforeUploadDocument?(message: string): Promise<any>;\n}\n\nconst getBase64 = (file: FileType): Promise<string> =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file as any);\n    reader.onload = () => resolve(reader.result as string);\n    reader.onerror = (error) => reject(error);\n  });\n\nconst MessageInput = ({\n  isShared = false,\n  disabled,\n  value,\n  onPressEnter,\n  sendDisabled,\n  sendLoading,\n  onInputChange,\n  conversationId,\n  showUploadIcon = true,\n  createConversationBeforeUploadDocument,\n  uploadMethod = 'upload_and_parse',\n}: IProps) => {\n  const { t } = useTranslate('chat');\n  const { removeDocument } = useRemoveNextDocument();\n  const { deleteDocument } = useDeleteDocument();\n  const { data: documentInfos, setDocumentIds } = useFetchDocumentInfosByIds();\n  const { uploadAndParseDocument } = useUploadAndParseDocument(uploadMethod);\n  const conversationIdRef = useRef(conversationId);\n\n  const [fileList, setFileList] = useState<UploadFile[]>([]);\n\n  const handlePreview = async (file: UploadFile) => {\n    if (!file.url && !file.preview) {\n      file.preview = await getBase64(file.originFileObj as FileType);\n    }\n  };\n\n  const handleChange: UploadProps['onChange'] = async ({\n    // fileList: newFileList,\n    file,\n  }) => {\n    let nextConversationId: string = conversationId;\n    if (createConversationBeforeUploadDocument) {\n      const creatingRet = await createConversationBeforeUploadDocument(\n        file.name,\n      );\n      if (creatingRet?.code === 0) {\n        nextConversationId = creatingRet.data.id;\n      }\n    }\n    setFileList((list) => {\n      list.push({\n        ...file,\n        status: 'uploading',\n        originFileObj: file as any,\n      });\n      return [...list];\n    });\n    const ret = await uploadAndParseDocument({\n      conversationId: nextConversationId,\n      fileList: [file],\n    });\n    setFileList((list) => {\n      const nextList = list.filter((x) => x.uid !== file.uid);\n      nextList.push({\n        ...file,\n        originFileObj: file as any,\n        response: ret,\n        percent: 100,\n        status: ret?.code === 0 ? 'done' : 'error',\n      });\n      return nextList;\n    });\n  };\n\n  const isUploadingFile = fileList.some((x) => x.status === 'uploading');\n\n  const handleKeyDown = useCallback(\n    async (event: React.KeyboardEvent<HTMLTextAreaElement>) => {\n      // check if it was shift + enter\n      if (event.key === 'Enter' && event.shiftKey) return;\n      if (event.key !== 'Enter') return;\n      if (sendDisabled || isUploadingFile || sendLoading) return;\n\n      event.preventDefault();\n      handlePressEnter();\n    },\n    [fileList, onPressEnter, isUploadingFile],\n  );\n\n  const handlePressEnter = useCallback(async () => {\n    if (isUploadingFile) return;\n    const ids = getFileIds(fileList.filter((x) => isUploadSuccess(x)));\n\n    onPressEnter(ids);\n    setFileList([]);\n  }, [fileList, onPressEnter, isUploadingFile]);\n\n  const [isComposing, setIsComposing] = useState(false);\n\n  const handleCompositionStart = () => setIsComposing(true);\n  const handleCompositionEnd = () => setIsComposing(false);\n\n  const handleRemove = useCallback(\n    async (file: UploadFile) => {\n      const ids = get(file, 'response.data', []);\n      // Upload Successfully\n      if (Array.isArray(ids) && ids.length) {\n        if (isShared) {\n          await deleteDocument(ids);\n        } else {\n          await removeDocument(ids[0]);\n        }\n        setFileList((preList) => {\n          return preList.filter((x) => getFileId(x) !== ids[0]);\n        });\n      } else {\n        // Upload failed\n        setFileList((preList) => {\n          return preList.filter((x) => x.uid !== file.uid);\n        });\n      }\n    },\n    [removeDocument, deleteDocument, isShared],\n  );\n\n  const getDocumentInfoById = useCallback(\n    (id: string) => {\n      return documentInfos.find((x) => x.id === id);\n    },\n    [documentInfos],\n  );\n\n  useEffect(() => {\n    const ids = getFileIds(fileList);\n    setDocumentIds(ids);\n  }, [fileList, setDocumentIds]);\n\n  useEffect(() => {\n    if (\n      conversationIdRef.current &&\n      conversationId !== conversationIdRef.current\n    ) {\n      setFileList([]);\n    }\n    conversationIdRef.current = conversationId;\n  }, [conversationId, setFileList]);\n\n  return (\n    <Flex gap={1} vertical className={styles.messageInputWrapper}>\n      <TextArea\n        size=\"large\"\n        placeholder={t('sendPlaceholder')}\n        value={value}\n        allowClear\n        disabled={disabled}\n        style={{\n          border: 'none',\n          boxShadow: 'none',\n          padding: '0px 10px',\n          marginTop: 10,\n        }}\n        autoSize={{ minRows: 2, maxRows: 10 }}\n        onKeyDown={handleKeyDown}\n        onChange={onInputChange}\n        onCompositionStart={handleCompositionStart}\n        onCompositionEnd={handleCompositionEnd}\n      />\n      <Divider style={{ margin: '5px 30px 10px 0px' }} />\n      <Flex justify=\"space-between\" align=\"center\">\n        {fileList.length > 0 && (\n          <List\n            grid={{\n              gutter: 16,\n              xs: 1,\n              sm: 1,\n              md: 1,\n              lg: 1,\n              xl: 2,\n              xxl: 4,\n            }}\n            dataSource={fileList}\n            className={styles.listWrapper}\n            renderItem={(item) => {\n              const id = getFileId(item);\n              const documentInfo = getDocumentInfoById(id);\n              const fileExtension = getExtension(documentInfo?.name ?? '');\n              const fileName = item.originFileObj?.name ?? '';\n\n              return (\n                <List.Item>\n                  <Card className={styles.documentCard}>\n                    <Flex gap={10} align=\"center\">\n                      {item.status === 'uploading' ? (\n                        <Spin\n                          indicator={\n                            <LoadingOutlined style={{ fontSize: 24 }} spin />\n                          }\n                        />\n                      ) : item.status === 'error' ? (\n                        <InfoCircleOutlined size={30}></InfoCircleOutlined>\n                      ) : (\n                        <FileIcon id={id} name={fileName}></FileIcon>\n                      )}\n                      <Flex vertical style={{ width: '90%' }}>\n                        <Text\n                          ellipsis={{ tooltip: fileName }}\n                          className={styles.nameText}\n                        >\n                          <b> {fileName}</b>\n                        </Text>\n                        {item.status === 'error' ? (\n                          t('uploadFailed')\n                        ) : (\n                          <>\n                            {item.percent !== 100 ? (\n                              t('uploading')\n                            ) : !item.response ? (\n                              t('parsing')\n                            ) : (\n                              <Space>\n                                <span>{fileExtension?.toUpperCase()},</span>\n                                <span>\n                                  {formatBytes(\n                                    getDocumentInfoById(id)?.size ?? 0,\n                                  )}\n                                </span>\n                              </Space>\n                            )}\n                          </>\n                        )}\n                      </Flex>\n                    </Flex>\n\n                    {item.status !== 'uploading' && (\n                      <span className={styles.deleteIcon}>\n                        <CloseCircleOutlined\n                          onClick={() => handleRemove(item)}\n                        />\n                      </span>\n                    )}\n                  </Card>\n                </List.Item>\n              );\n            }}\n          />\n        )}\n        <Flex\n          gap={5}\n          align=\"center\"\n          justify=\"flex-end\"\n          style={{\n            paddingRight: 10,\n            paddingBottom: 10,\n            width: fileList.length > 0 ? '50%' : '100%',\n          }}\n        >\n          {showUploadIcon && (\n            <Upload\n              onPreview={handlePreview}\n              onChange={handleChange}\n              multiple={false}\n              onRemove={handleRemove}\n              showUploadList={false}\n              beforeUpload={() => {\n                return false;\n              }}\n            >\n              <Button type={'primary'} disabled={disabled}>\n                <PaperClipOutlined />\n              </Button>\n            </Upload>\n          )}\n          <Button\n            type=\"primary\"\n            onClick={handlePressEnter}\n            loading={sendLoading}\n            disabled={sendDisabled || isUploadingFile || sendLoading}\n          >\n            <SendOutlined />\n          </Button>\n        </Flex>\n      </Flex>\n    </Flex>\n  );\n};\n\nexport default memo(MessageInput);\n","var __defProp = Object.defineProperty;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nimport * as React from \"react\";\nconst SvgDoctor = (props) => /* @__PURE__ */ React.createElement(\"svg\", __spreadValues({ className: \"doctor_svg__icon\", viewBox: \"0 0 1024 1024\", xmlns: \"http://www.w3.org/2000/svg\", width: 200, height: 200 }, props), /* @__PURE__ */ React.createElement(\"path\", { d: \"m368.76 621.76 24.07 132.54c9.54 52.6 55.34 90.84 108.79 90.84 51.49 0 96.12-35.64 107.52-85.85l1.02-5.03 23.61-132.33 100.48 22.34 5.61 1.36c61.12 16.18 104.55 70.31 107.08 133.49l.12 5.77v60.26l-.12 3.46c-1.71 22.71-19.72 40.78-42.42 42.56l-3.62.14H200.86l-3.46-.12c-22.71-1.71-40.78-19.72-42.56-42.42l-.14-3.62v-60.26l.12-5.77c2.53-63.17 45.96-117.31 107.08-133.49l5.61-1.36 101.25-22.51zm247.52-468.98 3.46.12c22.71 1.71 40.78 19.72 42.56 42.42l.14 3.62v138.47h-323.1V198.94l.12-3.46c1.71-22.71 19.72-40.78 42.42-42.56l3.62-.14h230.78zm-115.39 23.08c-11.7 0-21.55 8.76-22.92 20.38l-.16 2.7v23.08h-23.08c-12.75.01-23.07 10.36-23.05 23.1.01 11.68 8.75 21.51 20.35 22.89l2.7.16h23.08v23.08c.01 12.75 10.36 23.07 23.1 23.05 11.68-.01 21.51-8.75 22.89-20.35l.16-2.7v-23.08h23.08c12.75-.01 23.07-10.36 23.05-23.1-.01-11.68-8.75-21.51-20.35-22.89l-2.7-.16h-23.08v-23.08c.01-12.75-10.33-23.08-23.07-23.08z\", fill: \"#009FFF\" }), /* @__PURE__ */ React.createElement(\"path\", { d: \"M616.28 106.62c50.98 0 92.31 41.33 92.31 92.31v230.79a207.068 207.068 0 0 1-61.78 147.8l97.46 21.69c87.02 19.34 148.94 96.52 148.95 185.67v60.26c0 50.98-41.33 92.31-92.31 92.31H200.86c-50.98 0-92.31-41.33-92.31-92.31v-60.26c.01-89.15 61.93-166.33 148.95-185.67l97.46-21.69a207.051 207.051 0 0 1-61.78-147.8V198.94c0-50.98 41.33-92.31 92.31-92.31l230.79-.01zM368.76 621.76l-101.25 22.5c-63.81 14.18-110.07 69.54-112.69 134.85l-.12 5.79v60.24c-.01 24.15 18.61 44.23 42.7 46.04l3.46.12H800.9c24.15.01 44.23-18.61 46.04-42.7l.12-3.46v-60.26c0-65.36-44.01-122.53-107.2-139.26l-5.61-1.36-100.48-22.34-23.61 132.33c-9.39 52.58-55.12 90.88-108.54 90.88-53.45 0-99.25-38.24-108.79-90.84l-24.07-132.53zm132.13 15.67c-29.55.04-58.77-6.26-85.69-18.46l23.06 127.09c5.28 29.15 29.77 50.94 59.34 52.8l4.04.12c29.54-.01 55.26-20.2 62.27-48.9l.83-3.92 22.8-127.62a207.062 207.062 0 0 1-86.65 18.89zm66.65-60.51 5.72-2.72c2.31-1.15 4.57-2.35 6.81-3.62l-.92.51c49.68-27.49 81.27-79.05 83.2-135.79l.09-5.56v-46.16h-323.1v46.16c-.04 53.71 26.66 103.94 71.22 133.96l.53.35 4.85 3.12c1.95 1.21 3.93 2.38 5.93 3.51l-4.11-2.38c1.71 1.02 3.44 2.01 5.17 2.98l-1.06-.6c4.55 2.56 9.23 4.89 14.01 6.99l-1.5-.69c1.62.74 3.23 1.45 4.85 2.12l-3.35-1.43c2.01.9 4.06 1.73 6.12 2.54l-2.77-1.11c2.08.85 4.13 1.66 6.23 2.42L442 580.2c3.77 1.48 7.6 2.82 11.47 4.02l-4.85-1.59c2.35.81 4.73 1.57 7.15 2.26l-2.31-.69c1.78.55 3.55 1.06 5.33 1.55l-3.02-.85c2.01.6 4.06 1.15 6.09 1.64l-3.07-.78c2.35.65 4.75 1.22 7.15 1.75l-4.08-.97c1.98.51 3.97.95 5.95 1.38l-1.87-.42c2.65.58 5.33 1.11 8.05 1.55l-6.19-1.15c2.31.48 4.66.92 7.02 1.29l-.83-.14c2.08.37 4.15.67 6.25.92l-5.42-.78c2.61.44 5.24.78 7.87 1.08l-2.45-.3c2.08.28 4.13.48 6.19.69l-3.74-.39c2.08.23 4.15.44 6.28.58l6.35.35 5.56.09 5.54-.09 6.32-.35c2.34-.17 4.67-.38 6.99-.65l-4.52.46c2.01-.18 4.02-.39 6-.65l-1.48.18c5.54-.64 11.04-1.56 16.48-2.77l-2.45.51c2.31-.46 4.62-1.02 6.92-1.62l-4.48 1.08c2.01-.46 4.04-.92 6.02-1.45l-1.55.39c2.05-.53 4.08-1.08 6.12-1.68l-4.57 1.29c2.08-.55 4.15-1.15 6.21-1.78l-1.64.48c2.45-.72 4.85-1.5 7.27-2.33l-5.63 1.85c2.7-.83 5.38-1.73 8.03-2.7l-2.4.85c1.92-.69 3.83-1.38 5.75-2.12l-3.35 1.27c2.15-.81 4.27-1.62 6.37-2.49l-3.02 1.22c2.6-1.03 5.19-2.12 7.73-3.27zm48.74-424.14H385.49c-24.15-.01-44.23 18.61-46.04 42.7l-.12 3.46v138.47h323.1V198.94c.01-24.15-18.61-44.23-42.7-46.04l-3.45-.12zm-115.39 23.08c12.75 0 23.08 10.33 23.08 23.08v23.08h23.08c12.75.01 23.07 10.34 23.07 23.09-.01 12.74-10.33 23.06-23.07 23.07h-23.08v23.08c0 12.75-10.33 23.08-23.08 23.08-12.75 0-23.08-10.33-23.08-23.08v-23.08h-23.08c-12.75-.01-23.07-10.34-23.07-23.09.01-12.74 10.33-23.06 23.07-23.07h23.08v-23.08c0-12.75 10.33-23.08 23.08-23.08z\" }));\nexport { SvgDoctor as ReactComponent };\nexport default \"data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0ibTM2OC43NiA2MjEuNzYgMjQuMDcgMTMyLjU0YzkuNTQgNTIuNiA1NS4zNCA5MC44NCAxMDguNzkgOTAuODQgNTEuNDkgMCA5Ni4xMi0zNS42NCAxMDcuNTItODUuODVsMS4wMi01LjAzIDIzLjYxLTEzMi4zMyAxMDAuNDggMjIuMzQgNS42MSAxLjM2YzYxLjEyIDE2LjE4IDEwNC41NSA3MC4zMSAxMDcuMDggMTMzLjQ5bC4xMiA1Ljc3djYwLjI2bC0uMTIgMy40NmMtMS43MSAyMi43MS0xOS43MiA0MC43OC00Mi40MiA0Mi41NmwtMy42Mi4xNEgyMDAuODZsLTMuNDYtLjEyYy0yMi43MS0xLjcxLTQwLjc4LTE5LjcyLTQyLjU2LTQyLjQybC0uMTQtMy42MnYtNjAuMjZsLjEyLTUuNzdjMi41My02My4xNyA0NS45Ni0xMTcuMzEgMTA3LjA4LTEzMy40OWw1LjYxLTEuMzYgMTAxLjI1LTIyLjUxem0yNDcuNTItNDY4Ljk4IDMuNDYuMTJjMjIuNzEgMS43MSA0MC43OCAxOS43MiA0Mi41NiA0Mi40MmwuMTQgMy42MnYxMzguNDdoLTMyMy4xVjE5OC45NGwuMTItMy40NmMxLjcxLTIyLjcxIDE5LjcyLTQwLjc4IDQyLjQyLTQyLjU2bDMuNjItLjE0aDIzMC43OHptLTExNS4zOSAyMy4wOGMtMTEuNyAwLTIxLjU1IDguNzYtMjIuOTIgMjAuMzhsLS4xNiAyLjd2MjMuMDhoLTIzLjA4Yy0xMi43NS4wMS0yMy4wNyAxMC4zNi0yMy4wNSAyMy4xLjAxIDExLjY4IDguNzUgMjEuNTEgMjAuMzUgMjIuODlsMi43LjE2aDIzLjA4djIzLjA4Yy4wMSAxMi43NSAxMC4zNiAyMy4wNyAyMy4xIDIzLjA1IDExLjY4LS4wMSAyMS41MS04Ljc1IDIyLjg5LTIwLjM1bC4xNi0yLjd2LTIzLjA4aDIzLjA4YzEyLjc1LS4wMSAyMy4wNy0xMC4zNiAyMy4wNS0yMy4xLS4wMS0xMS42OC04Ljc1LTIxLjUxLTIwLjM1LTIyLjg5bC0yLjctLjE2aC0yMy4wOHYtMjMuMDhjLjAxLTEyLjc1LTEwLjMzLTIzLjA4LTIzLjA3LTIzLjA4eiIgZmlsbD0iIzAwOUZGRiIvPjxwYXRoIGQ9Ik02MTYuMjggMTA2LjYyYzUwLjk4IDAgOTIuMzEgNDEuMzMgOTIuMzEgOTIuMzF2MjMwLjc5YTIwNy4wNjggMjA3LjA2OCAwIDAgMS02MS43OCAxNDcuOGw5Ny40NiAyMS42OWM4Ny4wMiAxOS4zNCAxNDguOTQgOTYuNTIgMTQ4Ljk1IDE4NS42N3Y2MC4yNmMwIDUwLjk4LTQxLjMzIDkyLjMxLTkyLjMxIDkyLjMxSDIwMC44NmMtNTAuOTggMC05Mi4zMS00MS4zMy05Mi4zMS05Mi4zMXYtNjAuMjZjLjAxLTg5LjE1IDYxLjkzLTE2Ni4zMyAxNDguOTUtMTg1LjY3bDk3LjQ2LTIxLjY5YTIwNy4wNTEgMjA3LjA1MSAwIDAgMS02MS43OC0xNDcuOFYxOTguOTRjMC01MC45OCA0MS4zMy05Mi4zMSA5Mi4zMS05Mi4zMWwyMzAuNzktLjAxek0zNjguNzYgNjIxLjc2bC0xMDEuMjUgMjIuNWMtNjMuODEgMTQuMTgtMTEwLjA3IDY5LjU0LTExMi42OSAxMzQuODVsLS4xMiA1Ljc5djYwLjI0Yy0uMDEgMjQuMTUgMTguNjEgNDQuMjMgNDIuNyA0Ni4wNGwzLjQ2LjEySDgwMC45YzI0LjE1LjAxIDQ0LjIzLTE4LjYxIDQ2LjA0LTQyLjdsLjEyLTMuNDZ2LTYwLjI2YzAtNjUuMzYtNDQuMDEtMTIyLjUzLTEwNy4yLTEzOS4yNmwtNS42MS0xLjM2LTEwMC40OC0yMi4zNC0yMy42MSAxMzIuMzNjLTkuMzkgNTIuNTgtNTUuMTIgOTAuODgtMTA4LjU0IDkwLjg4LTUzLjQ1IDAtOTkuMjUtMzguMjQtMTA4Ljc5LTkwLjg0bC0yNC4wNy0xMzIuNTN6bTEzMi4xMyAxNS42N2MtMjkuNTUuMDQtNTguNzctNi4yNi04NS42OS0xOC40NmwyMy4wNiAxMjcuMDljNS4yOCAyOS4xNSAyOS43NyA1MC45NCA1OS4zNCA1Mi44bDQuMDQuMTJjMjkuNTQtLjAxIDU1LjI2LTIwLjIgNjIuMjctNDguOWwuODMtMy45MiAyMi44LTEyNy42MmEyMDcuMDYyIDIwNy4wNjIgMCAwIDEtODYuNjUgMTguODl6bTY2LjY1LTYwLjUxIDUuNzItMi43MmMyLjMxLTEuMTUgNC41Ny0yLjM1IDYuODEtMy42MmwtLjkyLjUxYzQ5LjY4LTI3LjQ5IDgxLjI3LTc5LjA1IDgzLjItMTM1Ljc5bC4wOS01LjU2di00Ni4xNmgtMzIzLjF2NDYuMTZjLS4wNCA1My43MSAyNi42NiAxMDMuOTQgNzEuMjIgMTMzLjk2bC41My4zNSA0Ljg1IDMuMTJjMS45NSAxLjIxIDMuOTMgMi4zOCA1LjkzIDMuNTFsLTQuMTEtMi4zOGMxLjcxIDEuMDIgMy40NCAyLjAxIDUuMTcgMi45OGwtMS4wNi0uNmM0LjU1IDIuNTYgOS4yMyA0Ljg5IDE0LjAxIDYuOTlsLTEuNS0uNjljMS42Mi43NCAzLjIzIDEuNDUgNC44NSAyLjEybC0zLjM1LTEuNDNjMi4wMS45IDQuMDYgMS43MyA2LjEyIDIuNTRsLTIuNzctMS4xMWMyLjA4Ljg1IDQuMTMgMS42NiA2LjIzIDIuNDJMNDQyIDU4MC4yYzMuNzcgMS40OCA3LjYgMi44MiAxMS40NyA0LjAybC00Ljg1LTEuNTljMi4zNS44MSA0LjczIDEuNTcgNy4xNSAyLjI2bC0yLjMxLS42OWMxLjc4LjU1IDMuNTUgMS4wNiA1LjMzIDEuNTVsLTMuMDItLjg1YzIuMDEuNiA0LjA2IDEuMTUgNi4wOSAxLjY0bC0zLjA3LS43OGMyLjM1LjY1IDQuNzUgMS4yMiA3LjE1IDEuNzVsLTQuMDgtLjk3YzEuOTguNTEgMy45Ny45NSA1Ljk1IDEuMzhsLTEuODctLjQyYzIuNjUuNTggNS4zMyAxLjExIDguMDUgMS41NWwtNi4xOS0xLjE1YzIuMzEuNDggNC42Ni45MiA3LjAyIDEuMjlsLS44My0uMTRjMi4wOC4zNyA0LjE1LjY3IDYuMjUuOTJsLTUuNDItLjc4YzIuNjEuNDQgNS4yNC43OCA3Ljg3IDEuMDhsLTIuNDUtLjNjMi4wOC4yOCA0LjEzLjQ4IDYuMTkuNjlsLTMuNzQtLjM5YzIuMDguMjMgNC4xNS40NCA2LjI4LjU4bDYuMzUuMzUgNS41Ni4wOSA1LjU0LS4wOSA2LjMyLS4zNWMyLjM0LS4xNyA0LjY3LS4zOCA2Ljk5LS42NWwtNC41Mi40NmMyLjAxLS4xOCA0LjAyLS4zOSA2LS42NWwtMS40OC4xOGM1LjU0LS42NCAxMS4wNC0xLjU2IDE2LjQ4LTIuNzdsLTIuNDUuNTFjMi4zMS0uNDYgNC42Mi0xLjAyIDYuOTItMS42MmwtNC40OCAxLjA4YzIuMDEtLjQ2IDQuMDQtLjkyIDYuMDItMS40NWwtMS41NS4zOWMyLjA1LS41MyA0LjA4LTEuMDggNi4xMi0xLjY4bC00LjU3IDEuMjljMi4wOC0uNTUgNC4xNS0xLjE1IDYuMjEtMS43OGwtMS42NC40OGMyLjQ1LS43MiA0Ljg1LTEuNSA3LjI3LTIuMzNsLTUuNjMgMS44NWMyLjctLjgzIDUuMzgtMS43MyA4LjAzLTIuN2wtMi40Ljg1YzEuOTItLjY5IDMuODMtMS4zOCA1Ljc1LTIuMTJsLTMuMzUgMS4yN2MyLjE1LS44MSA0LjI3LTEuNjIgNi4zNy0yLjQ5bC0zLjAyIDEuMjJjMi42LTEuMDMgNS4xOS0yLjEyIDcuNzMtMy4yN3ptNDguNzQtNDI0LjE0SDM4NS40OWMtMjQuMTUtLjAxLTQ0LjIzIDE4LjYxLTQ2LjA0IDQyLjdsLS4xMiAzLjQ2djEzOC40N2gzMjMuMVYxOTguOTRjLjAxLTI0LjE1LTE4LjYxLTQ0LjIzLTQyLjctNDYuMDRsLTMuNDUtLjEyem0tMTE1LjM5IDIzLjA4YzEyLjc1IDAgMjMuMDggMTAuMzMgMjMuMDggMjMuMDh2MjMuMDhoMjMuMDhjMTIuNzUuMDEgMjMuMDcgMTAuMzQgMjMuMDcgMjMuMDktLjAxIDEyLjc0LTEwLjMzIDIzLjA2LTIzLjA3IDIzLjA3aC0yMy4wOHYyMy4wOGMwIDEyLjc1LTEwLjMzIDIzLjA4LTIzLjA4IDIzLjA4LTEyLjc1IDAtMjMuMDgtMTAuMzMtMjMuMDgtMjMuMDh2LTIzLjA4aC0yMy4wOGMtMTIuNzUtLjAxLTIzLjA3LTEwLjM0LTIzLjA3LTIzLjA5LjAxLTEyLjc0IDEwLjMzLTIzLjA2IDIzLjA3LTIzLjA3aDIzLjA4di0yMy4wOGMwLTEyLjc1IDEwLjMzLTIzLjA4IDIzLjA4LTIzLjA4eiIvPjwvc3ZnPg==\";\n","import { useTranslation } from 'react-i18next';\nimport IndentedTree from './indented-tree';\n\nimport { useFetchKnowledgeGraph } from '@/hooks/knowledge-hooks';\nimport { IModalProps } from '@/interfaces/common';\nimport { Modal } from 'antd';\n\nconst IndentedTreeModal = ({\n  visible,\n  hideModal,\n}: IModalProps<any> & { documentId: string }) => {\n  const { data } = useFetchKnowledgeGraph();\n  const { t } = useTranslation();\n\n  return (\n    <Modal\n      title={t('chunk.mind')}\n      open={visible}\n      onCancel={hideModal}\n      width={'90vw'}\n      footer={null}\n    >\n      <section>\n        <IndentedTree data={data?.mind_map} show></IndentedTree>\n      </section>\n    </Modal>\n  );\n};\n\nexport default IndentedTreeModal;\n","import { Form, Input, Modal } from 'antd';\n\nimport { IModalProps } from '@/interfaces/common';\nimport { IFeedbackRequestBody } from '@/interfaces/request/chat';\nimport { useCallback } from 'react';\n\ntype FieldType = {\n  feedback?: string;\n};\n\nconst FeedbackModal = ({\n  visible,\n  hideModal,\n  onOk,\n  loading,\n}: IModalProps<IFeedbackRequestBody>) => {\n  const [form] = Form.useForm();\n\n  const handleOk = useCallback(async () => {\n    const ret = await form.validateFields();\n    return onOk?.({ thumbup: false, feedback: ret.feedback });\n  }, [onOk, form]);\n\n  return (\n    <Modal\n      title=\"Feedback\"\n      open={visible}\n      onOk={handleOk}\n      onCancel={hideModal}\n      confirmLoading={loading}\n    >\n      <Form\n        name=\"basic\"\n        labelCol={{ span: 0 }}\n        wrapperCol={{ span: 24 }}\n        style={{ maxWidth: 600 }}\n        autoComplete=\"off\"\n        form={form}\n      >\n        <Form.Item<FieldType>\n          name=\"feedback\"\n          rules={[{ required: true, message: 'Please input your feedback!' }]}\n        >\n          <Input.TextArea rows={8} placeholder=\"Please input your feedback!\" />\n        </Form.Item>\n      </Form>\n    </Modal>\n  );\n};\n\nexport default FeedbackModal;\n","import { IModalProps } from '@/interfaces/common';\nimport { IFeedbackRequestBody } from '@/interfaces/request/chat';\nimport { Modal, Space } from 'antd';\nimport HightLightMarkdown from '../highlight-markdown';\nimport SvgIcon from '../svg-icon';\n\nconst PromptModal = ({\n  visible,\n  hideModal,\n  prompt,\n}: IModalProps<IFeedbackRequestBody> & { prompt?: string }) => {\n  return (\n    <Modal\n      title={\n        <Space>\n          <SvgIcon name={`prompt`} width={18}></SvgIcon>\n          Prompt\n        </Space>\n      }\n      width={'80%'}\n      open={visible}\n      onCancel={hideModal}\n      footer={null}\n    >\n      <HightLightMarkdown>{prompt}</HightLightMarkdown>\n    </Modal>\n  );\n};\n\nexport default PromptModal;\n","import { PromptIcon } from '@/assets/icon/Icon';\nimport CopyToClipboard from '@/components/copy-to-clipboard';\nimport { useSetModalState } from '@/hooks/common-hooks';\nimport { IRemoveMessageById } from '@/hooks/logic-hooks';\nimport {\n  DeleteOutlined,\n  DislikeOutlined,\n  LikeOutlined,\n  PauseCircleOutlined,\n  SoundOutlined,\n  SyncOutlined,\n} from '@ant-design/icons';\nimport { Radio, Tooltip } from 'antd';\nimport { useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport FeedbackModal from './feedback-modal';\nimport { useRemoveMessage, useSendFeedback, useSpeech } from './hooks';\nimport PromptModal from './prompt-modal';\n\ninterface IProps {\n  messageId: string;\n  content: string;\n  prompt?: string;\n  showLikeButton: boolean;\n  audioBinary?: string;\n  showLoudspeaker?: boolean;\n}\n\nexport const AssistantGroupButton = ({\n  messageId,\n  content,\n  prompt,\n  audioBinary,\n  showLikeButton,\n  showLoudspeaker = true,\n}: IProps) => {\n  const { visible, hideModal, showModal, onFeedbackOk, loading } =\n    useSendFeedback(messageId);\n  const {\n    visible: promptVisible,\n    hideModal: hidePromptModal,\n    showModal: showPromptModal,\n  } = useSetModalState();\n  const { t } = useTranslation();\n  const { handleRead, ref, isPlaying } = useSpeech(content, audioBinary);\n\n  const handleLike = useCallback(() => {\n    onFeedbackOk({ thumbup: true });\n  }, [onFeedbackOk]);\n\n  return (\n    <>\n      <Radio.Group size=\"small\">\n        <Radio.Button value=\"a\">\n          <CopyToClipboard text={content}></CopyToClipboard>\n        </Radio.Button>\n        {showLoudspeaker && (\n          <Radio.Button value=\"b\" onClick={handleRead}>\n            <Tooltip title={t('chat.read')}>\n              {isPlaying ? <PauseCircleOutlined /> : <SoundOutlined />}\n            </Tooltip>\n            <audio src=\"\" ref={ref}></audio>\n          </Radio.Button>\n        )}\n        {showLikeButton && (\n          <>\n            <Radio.Button value=\"c\" onClick={handleLike}>\n              <LikeOutlined />\n            </Radio.Button>\n            <Radio.Button value=\"d\" onClick={showModal}>\n              <DislikeOutlined />\n            </Radio.Button>\n          </>\n        )}\n        {prompt && (\n          <Radio.Button value=\"e\" onClick={showPromptModal}>\n            <PromptIcon style={{ fontSize: '16px' }} />\n          </Radio.Button>\n        )}\n      </Radio.Group>\n      {visible && (\n        <FeedbackModal\n          visible={visible}\n          hideModal={hideModal}\n          onOk={onFeedbackOk}\n          loading={loading}\n        ></FeedbackModal>\n      )}\n      {promptVisible && (\n        <PromptModal\n          visible={promptVisible}\n          hideModal={hidePromptModal}\n          prompt={prompt}\n        ></PromptModal>\n      )}\n    </>\n  );\n};\n\ninterface UserGroupButtonProps extends Partial<IRemoveMessageById> {\n  messageId: string;\n  content: string;\n  regenerateMessage?: () => void;\n  sendLoading: boolean;\n}\n\nexport const UserGroupButton = ({\n  content,\n  messageId,\n  sendLoading,\n  removeMessageById,\n  regenerateMessage,\n}: UserGroupButtonProps) => {\n  const { onRemoveMessage, loading } = useRemoveMessage(\n    messageId,\n    removeMessageById,\n  );\n  const { t } = useTranslation();\n\n  return (\n    <Radio.Group size=\"small\">\n      <Radio.Button value=\"a\">\n        <CopyToClipboard text={content}></CopyToClipboard>\n      </Radio.Button>\n      {regenerateMessage && (\n        <Radio.Button\n          value=\"b\"\n          onClick={regenerateMessage}\n          disabled={sendLoading}\n        >\n          <Tooltip title={t('chat.regenerate')}>\n            <SyncOutlined spin={sendLoading} />\n          </Tooltip>\n        </Radio.Button>\n      )}\n      {removeMessageById && (\n        <Radio.Button value=\"c\" onClick={onRemoveMessage} disabled={loading}>\n          <Tooltip title={t('common.delete')}>\n            <DeleteOutlined spin={loading} />\n          </Tooltip>\n        </Radio.Button>\n      )}\n    </Radio.Group>\n  );\n};\n","import { useDeleteMessage, useFeedback } from '@/hooks/chat-hooks';\nimport { useSetModalState } from '@/hooks/common-hooks';\nimport { IRemoveMessageById, useSpeechWithSse } from '@/hooks/logic-hooks';\nimport { IFeedbackRequestBody } from '@/interfaces/request/chat';\nimport { hexStringToUint8Array } from '@/utils/common-util';\nimport { SpeechPlayer } from 'openai-speech-stream-player';\nimport { useCallback, useEffect, useRef, useState } from 'react';\n\nexport const useSendFeedback = (messageId: string) => {\n  const { visible, hideModal, showModal } = useSetModalState();\n  const { feedback, loading } = useFeedback();\n\n  const onFeedbackOk = useCallback(\n    async (params: IFeedbackRequestBody) => {\n      const ret = await feedback({\n        ...params,\n        messageId: messageId,\n      });\n\n      if (ret === 0) {\n        hideModal();\n      }\n    },\n    [feedback, hideModal, messageId],\n  );\n\n  return {\n    loading,\n    onFeedbackOk,\n    visible,\n    hideModal,\n    showModal,\n  };\n};\n\nexport const useRemoveMessage = (\n  messageId: string,\n  removeMessageById?: IRemoveMessageById['removeMessageById'],\n) => {\n  const { deleteMessage, loading } = useDeleteMessage();\n\n  const onRemoveMessage = useCallback(async () => {\n    if (messageId) {\n      const code = await deleteMessage(messageId);\n      if (code === 0) {\n        removeMessageById?.(messageId);\n      }\n    }\n  }, [deleteMessage, messageId, removeMessageById]);\n\n  return { onRemoveMessage, loading };\n};\n\nexport const useSpeech = (content: string, audioBinary?: string) => {\n  const ref = useRef<HTMLAudioElement>(null);\n  const { read } = useSpeechWithSse();\n  const player = useRef<SpeechPlayer>();\n  const [isPlaying, setIsPlaying] = useState<boolean>(false);\n\n  const initialize = useCallback(async () => {\n    player.current = new SpeechPlayer({\n      audio: ref.current!,\n      onPlaying: () => {\n        setIsPlaying(true);\n      },\n      onPause: () => {\n        setIsPlaying(false);\n      },\n      onChunkEnd: () => {},\n      mimeType: MediaSource.isTypeSupported('audio/mpeg')\n        ? 'audio/mpeg'\n        : 'audio/mp4; codecs=\"mp4a.40.2\"', // https://stackoverflow.com/questions/64079424/cannot-replay-mp3-in-firefox-using-mediasource-even-though-it-works-in-chrome\n    });\n    await player.current.init();\n  }, []);\n\n  const pause = useCallback(() => {\n    player.current?.pause();\n  }, []);\n\n  const speech = useCallback(async () => {\n    const response = await read({ text: content });\n    if (response) {\n      player?.current?.feedWithResponse(response);\n    }\n  }, [read, content]);\n\n  const handleRead = useCallback(async () => {\n    if (isPlaying) {\n      setIsPlaying(false);\n      pause();\n    } else {\n      setIsPlaying(true);\n      speech();\n    }\n  }, [setIsPlaying, speech, isPlaying, pause]);\n\n  useEffect(() => {\n    if (audioBinary) {\n      const units = hexStringToUint8Array(audioBinary);\n      if (units) {\n        try {\n          player.current?.feed(units);\n        } catch (error) {\n          console.warn(error);\n        }\n      }\n    }\n  }, [audioBinary]);\n\n  useEffect(() => {\n    initialize();\n  }, [initialize]);\n\n  return { ref, handleRead, isPlaying };\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"messageItem\":\"messageItem___OK1Zd\",\"messageItemSection\":\"messageItemSection___a_W_M\",\"messageItemSectionLeft\":\"messageItemSectionLeft___nCfnq\",\"messageItemContent\":\"messageItemContent___j99sG\",\"messageItemContentReverse\":\"messageItemContentReverse___EgYgc\",\"messageText\":\"messageText___vuU2B\",\"messageTextDark\":\"messageTextDark___mYdLd\",\"messageUserText\":\"messageUserText___yCJ20\",\"messageEmpty\":\"messageEmpty___oF9mg\",\"thumbnailImg\":\"thumbnailImg___ObcCZ\",\"messageItemLeft\":\"messageItemLeft___L270A\",\"messageItemRight\":\"messageItemRight___icDzT\"};","import { ReactComponent as AssistantIcon } from '@/assets/svg/doctor.svg';\nimport { MessageType } from '@/constants/chat';\nimport { useSetModalState } from '@/hooks/common-hooks';\nimport { IReference, IReferenceChunk } from '@/interfaces/database/chat';\nimport classNames from 'classnames';\nimport { memo, useCallback, useEffect, useMemo, useState } from 'react';\n\nimport {\n  useFetchDocumentInfosByIds,\n  useFetchDocumentThumbnailsByIds,\n} from '@/hooks/document-hooks';\nimport { IRegenerateMessage, IRemoveMessageById } from '@/hooks/logic-hooks';\nimport { IMessage } from '@/pages/chat/interface';\nimport MarkdownContent from '@/pages/chat/markdown-content';\nimport { getExtension, isImage } from '@/utils/document-util';\nimport { Avatar, Button, Flex, List, Space, Typography } from 'antd';\nimport FileIcon from '../file-icon';\nimport IndentedTreeModal from '../indented-tree/modal';\nimport NewDocumentLink from '../new-document-link';\nimport { useTheme } from '../theme-provider';\nimport { AssistantGroupButton, UserGroupButton } from './group-button';\nimport styles from './index.less';\n\nconst { Text } = Typography;\n\ninterface IProps extends Partial<IRemoveMessageById>, IRegenerateMessage {\n  item: IMessage;\n  reference: IReference;\n  loading?: boolean;\n  sendLoading?: boolean;\n  visibleAvatar?: boolean;\n  nickname?: string;\n  avatar?: string;\n  avatarDialog?: string | null;\n  clickDocumentButton?: (documentId: string, chunk: IReferenceChunk) => void;\n  index: number;\n  showLikeButton?: boolean;\n  showLoudspeaker?: boolean;\n}\n\nconst MessageItem = ({\n  item,\n  reference,\n  loading = false,\n  avatar,\n  avatarDialog,\n  sendLoading = false,\n  clickDocumentButton,\n  index,\n  removeMessageById,\n  regenerateMessage,\n  showLikeButton = true,\n  showLoudspeaker = true,\n  visibleAvatar = true,\n}: IProps) => {\n  const { theme } = useTheme();\n  const isAssistant = item.role === MessageType.Assistant;\n  const isUser = item.role === MessageType.User;\n  const { data: documentList, setDocumentIds } = useFetchDocumentInfosByIds();\n  const { data: documentThumbnails, setDocumentIds: setIds } =\n    useFetchDocumentThumbnailsByIds();\n  const { visible, hideModal, showModal } = useSetModalState();\n  const [clickedDocumentId, setClickedDocumentId] = useState('');\n\n  const referenceDocumentList = useMemo(() => {\n    return reference?.doc_aggs ?? [];\n  }, [reference?.doc_aggs]);\n  9222\n  const handleUserDocumentClick = useCallback(\n    (id: string) => () => {\n      setClickedDocumentId(id);\n      showModal();\n    },\n    [showModal],\n  );\n\n  const handleRegenerateMessage = useCallback(() => {\n    regenerateMessage?.(item);\n  }, [regenerateMessage, item]);\n\n  useEffect(() => {\n    const ids = item?.doc_ids ?? [];\n    if (ids.length) {\n      setDocumentIds(ids);\n      const documentIds = ids.filter((x) => !(x in documentThumbnails));\n      if (documentIds.length) {\n        setIds(documentIds);9222\n      }\n    }\n  }, [item.doc_ids, setDocumentIds, setIds, documentThumbnails]);\n\n  return (\n    <div\n      className={classNames(styles.messageItem, {\n        [styles.messageItemLeft]: item.role === MessageType.Assistant,\n        [styles.messageItemRight]: item.role === MessageType.User,\n      })}\n    >\n      <section\n        className={classNames(styles.messageItemSection, {\n          [styles.messageItemSectionLeft]: item.role === MessageType.Assistant,\n          [styles.messageItemSectionRight]: item.role === MessageType.User,\n        })}\n      >\n        <div\n          className={classNames(styles.messageItemContent, {\n            [styles.messageItemContentReverse]: item.role === MessageType.User,\n          })}\n        >\n          {visibleAvatar &&\n            (item.role === MessageType.User ? (\n              <Avatar size={40} src={avatar ?? '/user.jpg'} />\n            ) : avatarDialog ? (\n              <Avatar size={40} src={avatarDialog} />\n            ) : (\n              <AssistantIcon  style={{ width: '38px', height: '38px' }} />\n            ))}\n\n          <Flex vertical gap={8} flex={1}>\n            <Space>\n              {isAssistant ? (\n                index !== 0 && (\n                  <AssistantGroupButton\n                    messageId={item.id}\n                    content={item.content}\n                    prompt={item.prompt}\n                    showLikeButton={showLikeButton}\n                    audioBinary={item.audio_binary}\n                    showLoudspeaker={showLoudspeaker}\n                  ></AssistantGroupButton>\n                )\n              ) : (\n                <UserGroupButton\n                  content={item.content}\n                  messageId={item.id}\n                  removeMessageById={removeMessageById}\n                  regenerateMessage={\n                    regenerateMessage && handleRegenerateMessage\n                  }\n                  sendLoading={sendLoading}\n                ></UserGroupButton>\n              )}\n\n              {/* <b>{isAssistant ? '' : nickname}</b> */}\n            </Space>\n            <div\n              className={\n                isAssistant\n                  ? theme === 'dark'\n                    ? styles.messageTextDark\n                    : styles.messageText\n                  : styles.messageUserText\n              }\n              style={{ maxWidth: '664px' }}\n            >\n              <MarkdownContent\n                loading={loading}\n                content={item.content}\n                reference={reference}\n                clickDocumentButton={clickDocumentButton}\n              ></MarkdownContent>\n            </div>\n            {isAssistant && referenceDocumentList.length > 0 && (\n              <List\n                bordered\n                dataSource={referenceDocumentList}\n                renderItem={(item) => {\n                  return (\n                    <List.Item>\n                      <Flex gap={'small'} align=\"center\">\n                        <FileIcon\n                          id={item.doc_id}\n                          name={item.doc_name}\n                        ></FileIcon>\n\n                        <NewDocumentLink\n                          documentId={item.doc_id}\n                          documentName={item.doc_name}\n                          prefix=\"document\"\n                          link={item.url}\n                        >\n                          {item.doc_name}\n                        </NewDocumentLink>\n                      </Flex>\n                    </List.Item>\n                  );\n                }}\n              />\n            )}\n            {isUser && documentList.length > 0 && (\n              <List\n                bordered\n                dataSource={documentList}\n                renderItem={(item) => {\n                  // TODO:\n                  // const fileThumbnail =\n                  //   documentThumbnails[item.id] || documentThumbnails[item.id];\n                  const fileExtension = getExtension(item.name);\n                  return (\n                    <List.Item>\n                      <Flex gap={'small'} align=\"center\">\n                        <FileIcon id={item.id} name={item.name}></FileIcon>\n\n                        {isImage(fileExtension) ? (\n                          <NewDocumentLink\n                            documentId={item.id}\n                            documentName={item.name}\n                            prefix=\"document\"\n                          >\n                            {item.name}\n                          </NewDocumentLink>\n                        ) : (\n                          <Button\n                            type={'text'}\n                            onClick={handleUserDocumentClick(item.id)}\n                          >\n                            <Text\n                              style={{ maxWidth: '40vw' }}\n                              ellipsis={{ tooltip: item.name }}\n                            >\n                              {item.name}\n                            </Text>\n                          </Button>\n                        )}\n                      </Flex>\n                    </List.Item>\n                  );\n                }}\n              />\n            )}\n          </Flex>\n        </div>\n      </section>\n      {visible && (\n        <IndentedTreeModal\n          visible={visible}\n          hideModal={hideModal}\n          documentId={clickedDocumentId}\n        ></IndentedTreeModal>\n      )}\n    </div>\n  );\n};\n\nexport default memo(MessageItem);\n","import api from '@/utils/api';\nimport registerServer from '@/utils/register-server';\nimport request from '@/utils/request';\n\nconst {\n  listFile,\n  removeFile,\n  uploadFile,\n  renameFile,\n  getAllParentFolder,\n  createFolder,\n  connectFileToKnowledge,\n  get_document_file,\n  getFile,\n  moveFile,\n} = api;\n\nconst methods = {\n  listFile: {\n    url: listFile,\n    method: 'get',\n  },\n  removeFile: {\n    url: removeFile,\n    method: 'post',\n  },\n  uploadFile: {\n    url: uploadFile,\n    method: 'post',\n  },\n  renameFile: {\n    url: renameFile,\n    method: 'post',\n  },\n  getAllParentFolder: {\n    url: getAllParentFolder,\n    method: 'get',\n  },\n  createFolder: {\n    url: createFolder,\n    method: 'post',\n  },\n  connectFileToKnowledge: {\n    url: connectFileToKnowledge,\n    method: 'post',\n  },\n  getFile: {\n    url: getFile,\n    method: 'get',\n    responseType: 'blob',\n  },\n  getDocumentFile: {\n    url: get_document_file,\n    method: 'get',\n    responseType: 'blob',\n  },\n  moveFile: {\n    url: moveFile,\n    method: 'post',\n  },\n} as const;\n\nconst fileManagerService = registerServer<keyof typeof methods>(\n  methods,\n  request,\n);\n\nexport default fileManagerService;\n","import { FileMimeType } from '@/constants/common';\nimport fileManagerService from '@/services/file-manager-service';\nimport { UploadFile } from 'antd';\n\nexport const transformFile2Base64 = (val: any): Promise<any> => {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(val);\n    reader.onload = (): void => {\n      // Create image object\n      const img = new Image();\n      img.src = reader.result as string;\n\n      img.onload = () => {\n        // Create canvas\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n\n        // Calculate compressed dimensions, set max width/height to 800px\n        let width = img.width;\n        let height = img.height;\n        const maxSize = 100;\n\n        if (width > height && width > maxSize) {\n          height = (height * maxSize) / width;\n          width = maxSize;\n        } else if (height > maxSize) {\n          width = (width * maxSize) / height;\n          height = maxSize;\n        }\n\n        // Set canvas dimensions\n        canvas.width = width;\n        canvas.height = height;\n\n        // Draw image\n        ctx?.drawImage(img, 0, 0, width, height);\n\n        // Convert to base64, maintain original format and transparency\n        const compressedBase64 = canvas.toDataURL('image/png');\n        resolve(compressedBase64);\n      };\n\n      img.onerror = reject;\n    };\n    reader.onerror = reject;\n  });\n};\n\nexport const transformBase64ToFile = (\n  dataUrl: string,\n  filename: string = 'file',\n) => {\n  let arr = dataUrl.split(','),\n    bstr = atob(arr[1]),\n    n = bstr.length,\n    u8arr = new Uint8Array(n);\n\n  const mime = arr[0].match(/:(.*?);/);\n  const mimeType = mime ? mime[1] : 'image/png';\n\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n);\n  }\n  return new File([u8arr], filename, { type: mimeType });\n};\n\nexport const normFile = (e: any) => {\n  if (Array.isArray(e)) {\n    return e;\n  }\n  return e?.fileList;\n};\n\nexport const getUploadFileListFromBase64 = (avatar: string) => {\n  let fileList: UploadFile[] = [];\n\n  if (avatar) {\n    fileList = [{ uid: '1', name: 'file', thumbUrl: avatar, status: 'done' }];\n  }\n\n  return fileList;\n};\n\nexport const getBase64FromUploadFileList = async (fileList?: UploadFile[]) => {\n  if (Array.isArray(fileList) && fileList.length > 0) {\n    const file = fileList[0];\n    const originFileObj = file.originFileObj;\n    if (originFileObj) {\n      const base64 = await transformFile2Base64(originFileObj);\n      return base64;\n    } else {\n      return file.thumbUrl;\n    }\n    // return fileList[0].thumbUrl; TODO: Even JPG files will be converted to base64 parameters in png format\n  }\n\n  return '';\n};\n\nasync function fetchDocumentBlob(id: string, mimeType?: FileMimeType) {\n  const response = await fileManagerService.getDocumentFile({}, id);\n  const blob = new Blob([response.data], {\n    type: mimeType || response.data.type,\n  });\n\n  return blob;\n}\n\nexport async function previewHtmlFile(id: string) {\n  const blob = await fetchDocumentBlob(id, FileMimeType.Html);\n  const url = URL.createObjectURL(blob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.click();\n  URL.revokeObjectURL(url);\n}\n\nexport const downloadFileFromBlob = (blob: Blob, name?: string) => {\n  const url = window.URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  if (name) {\n    a.download = name;\n  }\n  a.click();\n  window.URL.revokeObjectURL(url);\n};\n\nexport const downloadDocument = async ({\n  id,\n  filename,\n}: {\n  id: string;\n  filename?: string;\n}) => {\n  const blob = await fetchDocumentBlob(id);\n  downloadFileFromBlob(blob, filename);\n};\n\nconst Units = ['bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n\nexport const formatBytes = (x: string | number) => {\n  let l = 0,\n    n = (typeof x === 'string' ? parseInt(x, 10) : x) || 0;\n\n  while (n >= 1024 && ++l) {\n    n = n / 1024;\n  }\n\n  return n.toFixed(n < 10 && l > 0 ? 1 : 0) + ' ' + Units[l];\n};\n\nexport const downloadJsonFile = async (\n  data: Record<string, any>,\n  fileName: string,\n) => {\n  const blob = new Blob([JSON.stringify(data)], { type: FileMimeType.Json });\n  downloadFileFromBlob(blob, fileName);\n};\n"],"names":["_ref","text","_useState","useState","_useState2","_slicedToArray","copied","setCopied","t","useTranslate","_jsx","Tooltip","title","children","Clipboard","onCopy","setTimeout","CheckOutlined","CopyOutlined","Text","Typography","TextArea","Input","getFileId","file","get","getFileIds","fileList","reduce","pre","cur","concat","getBase64","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","MessageInput","_ref$isShared","isShared","disabled","value","onPressEnter","sendDisabled","sendLoading","onInputChange","conversationId","_ref$showUploadIcon","showUploadIcon","createConversationBeforeUploadDocument","_ref$uploadMethod","uploadMethod","removeDocument","useRemoveNextDocument","deleteDocument","useDeleteDocument","_useFetchDocumentInfo","useFetchDocumentInfosByIds","documentInfos","data","setDocumentIds","uploadAndParseDocument","useUploadAndParseDocument","conversationIdRef","useRef","setFileList","handlePreview","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","url","preview","originFileObj","sent","stop","_x","apply","arguments","handleChange","_ref4","_callee2","_ref3","nextConversationId","creatingRet","ret","_context2","name","code","id","list","push","_objectSpread","status","_toConsumableArray","nextList","filter","x","uid","response","percent","_x2","isUploadingFile","some","handleKeyDown","useCallback","_ref5","_callee3","event","_context3","key","shiftKey","abrupt","preventDefault","handlePressEnter","_x3","_callee4","ids","_context4","_useState3","_useState4","setIsComposing","handleRemove","_ref7","_callee5","_context5","Array","isArray","length","preList","_x4","getDocumentInfoById","find","useEffect","current","_jsxs","Flex","gap","vertical","className","styles","messageInputWrapper","size","placeholder","allowClear","style","border","boxShadow","padding","marginTop","autoSize","minRows","maxRows","onKeyDown","onChange","onCompositionStart","onCompositionEnd","Divider","margin","justify","align","List","grid","gutter","xs","sm","md","lg","xl","xxl","dataSource","listWrapper","renderItem","item","_documentInfo$name","_item$originFileObj$n","_item$originFileObj","_getDocumentInfoById$","_getDocumentInfoById","documentInfo","fileExtension","getExtension","fileName","Item","Card","documentCard","Spin","indicator","LoadingOutlined","fontSize","spin","InfoCircleOutlined","FileIcon","width","ellipsis","tooltip","nameText","_Fragment","Space","toUpperCase","formatBytes","deleteIcon","CloseCircleOutlined","onClick","paddingRight","paddingBottom","Upload","onPreview","multiple","onRemove","showUploadList","beforeUpload","Button","type","PaperClipOutlined","loading","SendOutlined","memo","__defProp","Object","defineProperty","__getOwnPropSymbols","getOwnPropertySymbols","__hasOwnProp","prototype","hasOwnProperty","__propIsEnum","propertyIsEnumerable","__defNormalProp","obj","enumerable","configurable","writable","SvgDoctor","props","a","b","prop","call","__spreadValues","viewBox","xmlns","height","d","fill","visible","hideModal","useFetchKnowledgeGraph","useTranslation","Modal","open","onCancel","footer","IndentedTree","mind_map","show","onOk","_Form$useForm","Form","useForm","form","handleOk","validateFields","thumbup","feedback","confirmLoading","labelCol","span","wrapperCol","maxWidth","autoComplete","rules","required","message","rows","prompt","SvgIcon","HightLightMarkdown","AssistantGroupButton","messageId","content","audioBinary","showLikeButton","_ref$showLoudspeaker","showLoudspeaker","_useSendFeedback","_useSetModalState","useSetModalState","showModal","_useFeedback","useFeedback","onFeedbackOk","params","useSendFeedback","promptVisible","hidePromptModal","showPromptModal","_useSpeech","ref","read","useSpeechWithSse","player","isPlaying","setIsPlaying","initialize","SpeechPlayer","audio","onPlaying","onPause","onChunkEnd","mimeType","MediaSource","isTypeSupported","init","pause","_player$current","speech","_player$current2","feedWithResponse","handleRead","units","hexStringToUint8Array","_player$current3","feed","console","warn","useSpeech","handleLike","Radio","CopyToClipboard","PauseCircleOutlined","SoundOutlined","src","LikeOutlined","DislikeOutlined","PromptIcon","FeedbackModal","PromptModal","UserGroupButton","removeMessageById","regenerateMessage","_useRemoveMessage","_useDeleteMessage","useDeleteMessage","deleteMessage","onRemoveMessage","useRemoveMessage","SyncOutlined","DeleteOutlined","MessageItem","reference","_ref$loading","avatar","avatarDialog","_ref$sendLoading","clickDocumentButton","index","_ref$showLikeButton","_ref$visibleAvatar","visibleAvatar","theme","useTheme","isAssistant","role","MessageType","Assistant","isUser","User","documentList","_useFetchDocumentThum","useFetchDocumentThumbnailsByIds","documentThumbnails","setIds","clickedDocumentId","setClickedDocumentId","referenceDocumentList","useMemo","_reference$doc_aggs","doc_aggs","handleUserDocumentClick","handleRegenerateMessage","_item$doc_ids","doc_ids","documentIds","classNames","messageItem","_defineProperty","messageItemLeft","messageItemRight","messageItemSection","messageItemSectionLeft","messageItemSectionRight","messageItemContent","messageItemContentReverse","Avatar","AssistantIcon","flex","audio_binary","messageTextDark","messageText","messageUserText","MarkdownContent","bordered","doc_id","doc_name","NewDocumentLink","documentId","documentName","prefix","link","isImage","IndentedTreeModal","listFile","api","removeFile","uploadFile","renameFile","getAllParentFolder","createFolder","connectFileToKnowledge","get_document_file","methods","method","getFile","responseType","getDocumentFile","moveFile","fileManagerService","registerServer","request","transformFile2Base64","val","img","Image","canvas","document","createElement","ctx","getContext","maxSize","drawImage","compressedBase64","toDataURL","normFile","e","getUploadFileListFromBase64","thumbUrl","getBase64FromUploadFileList","base64","fetchDocumentBlob","_fetchDocumentBlob","blob","Blob","previewHtmlFile","_previewHtmlFile","FileMimeType","Html","URL","createObjectURL","href","click","revokeObjectURL","downloadFileFromBlob","window","download","downloadDocument","filename","_x5","Units","l","n","parseInt","toFixed","downloadJsonFile","JSON","stringify","Json","_x6","_x7"],"sourceRoot":""}